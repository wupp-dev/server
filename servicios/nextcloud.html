<!DOCTYPE html>
<html lang="es-ES" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Nextcloud | Servidor mamadísimo</title>
    <meta name="description" content="Guía del servidor.">
    <link rel="preload stylesheet" href="/server/assets/style.d4fb01d9.css" as="style">
    <script type="module" src="/server/assets/app.6547af30.js"></script>
    <link rel="preload" href="/server/assets/inter-roman-latin.2ed14f66.woff2" as="font" type="font/woff2" crossorigin="">
  <link rel="modulepreload" href="/server/assets/chunks/framework.d334b221.js">
  <link rel="modulepreload" href="/server/assets/chunks/theme.96573fc8.js">
  <link rel="modulepreload" href="/server/assets/servicios_nextcloud.md.8a516859.lean.js">
  <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-b2cf3e0b><!--[--><!--]--><!--[--><span tabindex="-1" data-v-b8b11faa></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-b8b11faa> Skip to content </a><!--]--><!----><header class="VPNav" data-v-b2cf3e0b data-v-7e5bc4a5><div class="VPNavBar has-sidebar" data-v-7e5bc4a5 data-v-7683ced7><div class="container" data-v-7683ced7><div class="title" data-v-7683ced7><div class="VPNavBarTitle has-sidebar" data-v-7683ced7 data-v-4d981103><a class="title" href="/server/" data-v-4d981103><!--[--><!--]--><!----><!--[-->Servidor mamadísimo<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-7683ced7><div class="curtain" data-v-7683ced7></div><div class="content-body" data-v-7683ced7><!--[--><!--]--><div class="VPNavBarSearch search" style="--vp-meta-key:&#39;Meta&#39;;" data-v-7683ced7><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-7683ced7 data-v-7f418b0f><span id="main-nav-aria-label" class="visually-hidden" data-v-7f418b0f>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/server/" tabindex="0" data-v-7f418b0f data-v-5e623618 data-v-8f4dc553><!--[-->Inicio<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/server/equipo/hardware.html" tabindex="0" data-v-7f418b0f data-v-5e623618 data-v-8f4dc553><!--[-->Guía del servidor<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="https://github.com/ComicIvans/server" target="_blank" rel="noreferrer" tabindex="0" data-v-7f418b0f data-v-5e623618 data-v-8f4dc553><!--[-->Archivos de configuración<!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-8f4dc553><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-7683ced7 data-v-f6a63727><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-f6a63727 data-v-82b282f1 data-v-f3c41672><span class="check" data-v-f3c41672><span class="icon" data-v-f3c41672><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-82b282f1><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-82b282f1><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-7683ced7 data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink" href="https://discord.gg/YdnmG5v8" aria-label="discord" target="_blank" rel="noopener" data-v-7bc22406 data-v-36371990><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Discord</title><path d="M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.4189-2.1568 2.4189Z"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-7683ced7 data-v-40855f84 data-v-764effdf><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-764effdf><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-764effdf><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-764effdf><div class="VPMenu" data-v-764effdf data-v-e7ea1737><!----><!--[--><!--[--><!----><div class="group" data-v-40855f84><div class="item appearance" data-v-40855f84><p class="label" data-v-40855f84>Appearance</p><div class="appearance-action" data-v-40855f84><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-40855f84 data-v-82b282f1 data-v-f3c41672><span class="check" data-v-f3c41672><span class="icon" data-v-f3c41672><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-82b282f1><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-82b282f1><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-40855f84><div class="item social-links" data-v-40855f84><div class="VPSocialLinks social-links-list" data-v-40855f84 data-v-7bc22406><!--[--><a class="VPSocialLink" href="https://discord.gg/YdnmG5v8" aria-label="discord" target="_blank" rel="noopener" data-v-7bc22406 data-v-36371990><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Discord</title><path d="M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.4189-2.1568 2.4189Z"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-7683ced7 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav" data-v-b2cf3e0b data-v-9074c407><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-9074c407><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-9074c407><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-9074c407>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-9074c407 data-v-687955bc><button data-v-687955bc>Return to top</button><!----></div></div><aside class="VPSidebar" data-v-b2cf3e0b data-v-af16598e><div class="curtain" data-v-af16598e></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-af16598e><span class="visually-hidden" id="sidebar-aria-label" data-v-af16598e> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-af16598e><section class="VPSidebarItem level-0" data-v-af16598e data-v-c4656e6d><div class="item" role="button" tabindex="0" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><h2 class="text" data-v-c4656e6d>Equipo</h2><!----></div><div class="items" data-v-c4656e6d><!--[--><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/server/equipo/hardware.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>Hardware</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/server/equipo/sistema-encriptado.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>Instalación del SO encriptado</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/server/equipo/router-dominio.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>Configuración del router y dominio</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/server/equipo/gestion-remota.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>Gestión remota con SSH y VNC</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/server/equipo/nginx.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>Nginx como servidor web</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/server/equipo/docker.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>Docker</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/server/equipo/mariadb-docker.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>Configurando MariaDB con Docker</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-af16598e><section class="VPSidebarItem level-0 has-active" data-v-af16598e data-v-c4656e6d><div class="item" role="button" tabindex="0" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><h2 class="text" data-v-c4656e6d>Servicios</h2><!----></div><div class="items" data-v-c4656e6d><!--[--><div class="VPSidebarItem level-1 is-link is-active has-active" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/server/servicios/nextcloud.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>Nextcloud - Almacenamiento</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/server/servicios/minecraft.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>Minecraft con AMP</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/server/servicios/dozzle.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>Dozzle - Visualizador de logs</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/server/servicios/homarr.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>Homarr - Dashboard</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/server/servicios/uptime-kuma.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>Uptime Kuma - Status</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/server/servicios/authentik.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>Authentik - Autenticación</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/server/servicios/gogs.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>Gitea - Servicio git</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/server/servicios/navidrome.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>Navidrome - Streaming de música</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/server/servicios/sharelatex.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>Overleaf - Editor de LaTeX</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/server/servicios/docker-mailserver.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>Docker Mailserver - Servidor de correo</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-af16598e><section class="VPSidebarItem level-0" data-v-af16598e data-v-c4656e6d><div class="item" role="button" tabindex="0" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><h2 class="text" data-v-c4656e6d>Relatos</h2><!----></div><div class="items" data-v-c4656e6d><!--[--><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/server/relatos/bloqueo-ssh.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>Bloqueo de SSH</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/server/relatos/usuario-docker.html" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>Lucas vs. Debian & Docker & etc.</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-b2cf3e0b data-v-a494bd1d><div class="VPDoc has-sidebar has-aside" data-v-a494bd1d data-v-c4b0d3cf><!--[--><!--]--><div class="container" data-v-c4b0d3cf><div class="aside" data-v-c4b0d3cf><div class="aside-curtain" data-v-c4b0d3cf></div><div class="aside-container" data-v-c4b0d3cf><div class="aside-content" data-v-c4b0d3cf><div class="VPDocAside" data-v-c4b0d3cf data-v-3f215769><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" data-v-3f215769 data-v-ff0f39c8><div class="content" data-v-ff0f39c8><div class="outline-marker" data-v-ff0f39c8></div><div class="outline-title" data-v-ff0f39c8>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-ff0f39c8><span class="visually-hidden" id="doc-outline-aria-label" data-v-ff0f39c8> Table of Contents for current page </span><ul class="root" data-v-ff0f39c8 data-v-9a431c33><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-c4b0d3cf><div class="content-container" data-v-c4b0d3cf><!--[--><!--]--><!----><main class="main" data-v-c4b0d3cf><div style="position:relative;" class="vp-doc _server_servicios_nextcloud" data-v-c4b0d3cf><div><h1 id="nextcloud-almacenamiento" tabindex="-1">Nextcloud - Almacenamiento <a class="header-anchor" href="#nextcloud-almacenamiento" aria-label="Permalink to &quot;Nextcloud - Almacenamiento&quot;">​</a></h1><p>Por fin llegó el momento de poner en marcha el primer servicio, y qué mejor elección que <a href="https://nextcloud.com/es/" target="_blank" rel="noreferrer">Nextcloud</a>. Antes de empezar asegúrate de que tienes un subdominio creado para Nextcloud como <code>cloud.wupp.dev</code>.</p><h2 id="configurando-docker" tabindex="-1">Configurando Docker <a class="header-anchor" href="#configurando-docker" aria-label="Permalink to &quot;Configurando Docker&quot;">​</a></h2><p>Empezamos escribiendo en el <code>docker-compose.yml</code> todo lo necesario para tener una instalación funcional de Nextcloud:</p><div class="language-yml"><button title="Copy Code" class="copy"></button><span class="lang">yml</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F07178;">services</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">nextcloud-db</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">postgres</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">restart</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">always</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">environment</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">POSTGRES_USER=nextcloud</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">POSTGRES_PASSWORD=pwd</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">POSTGRES_DB=nextcloud</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">volumes</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/var/lib/nextcloud/postgresql/data:/var/lib/postgresql:Z</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">nextcloud-redis</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">redis</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">command</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">redis-server --requirepass pwd</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">nextcloud</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nextcloud:fpm</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">restart</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">always</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">depends_on</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nextcloud-db</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nextcloud-redis</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">environment</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">POSTGRES_HOST=nextcloud-db</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">NEXTCLOUD_TRUSTED_DOMAINS=cloud.wupp.dev</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">REDIS_HOST=nextcloud-redis</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">REDIS_HOST_PORT=6379</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">REDIS_HOST_PASSWORD=pwd</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">PHP_MEMORY_LIMIT=50G</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">PHP_UPLOAD_LIMIT=50G</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">ports</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">9000:9000</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">volumes</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/var/www/nextcloud:/var/www/html</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">nextcloud-cron</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nextcloud:fpm</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">restart</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">always</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">depends_on</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nextcloud-db</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nextcloud-redis</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">volumes</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/var/www/nextcloud:/var/www/html</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">entrypoint</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/cron.sh</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">nextcloud-imaginary</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nextcloud/aio-imaginary:latest</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">restart</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">always</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">ports</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">9090:9000</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">command</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-concurrency 20 -enable-url-source -return-size</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">cap_add</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">SYS_NICE</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Hemos decidido usar PostgreSQL como base de datos para Nextcloud por preferencia personal, pero se puede configurar sin mucha distinción con MariaDB, que es de hecho como empezarmos a usarlo.</p></div><p>Lo primero que cabe destacar es que en este nuevo archivo, los usuarios y las contraseñas están directamente escritos. Esto no es una buena práctica de seguridad, pero para la guía lo vamos a dejar así, dejando claro que a la hora de implementarlo deberían usarse <a href="https://docs.docker.com/engine/swarm/secrets/" target="_blank" rel="noreferrer">secretos de docker</a>. Una excepción que hemos hecho a esto es redis, que por unos cuantos problemas que nos ha dado lo hemos dejado sin contraseña, aunque se puede usar con contraseña siempre que esté escrita en el <code>docker-compose.yml</code> en el comando de iniciación de redis (y se le pase a Nextcloud).</p><p>Vamos a analizar un poco el documento, concretamente los servicios que hay declarados:</p><ul><li><code>nextcloud-db</code>: Esta será la base de datos de Nextcloud. En <code>environment</code> simplemente se establece un usuario, contraseña y base de datos a crear, que serán para Nextcloud. Por último, <code>volumes</code> permite que los datos guardados se conserven aunque el servicio se reinicie y la <code>Z</code> la puso Lucas en por verla en la documentación, <a href="https://docs.docker.com/storage/bind-mounts/#configure-the-selinux-label" target="_blank" rel="noreferrer">aquí</a> se explica lo que hace.</li><li><code>nextcloud-redis</code>: Es otra base de datos pero que en este caso Nextcloud utilizará para almacenar archivos en caché y así tener un mejor rendimiento. También se usará para gestionar los inicios de sesión. En <code>command</code> se puede especificar la contraseña.</li><li><code>nextcloud</code>: Tiene el mapeo de puertos <code>9000:9000</code> para que Nginx pueda redirigir las solicitudes PHP dentro del contenedor. Además, <code>depends_on</code> indica que tanto <code>nextcloud-db</code> como <code>nextcloud-redis</code> deben estar funcionando para que Nextcloud lo haga. Por último se hace igual que en <code>nextcloud-db</code> un mapeo de carpetas para conservar los datos y se establecen las variables de entorno para configurar Nextcloud.</li><li><code>nextcloud-cron</code>: Este contenedor es peculiar. Es necesario solo si planeas que Nextcloud lo vaya a usar más de una persona, para reducir la carga de trabajo del servidor. Lo único que hace es ejecutar puntualmente una tarea de <code>cron</code> dentro de los archivos de Nextcloud para hacer labores de mantenimiento y limpieza de forma automática.</li><li><code>nextcloud-imaginary</code>: La imagen actualizada por Nextcloud de <a href="https://github.com/h2non/imaginary" target="_blank" rel="noreferrer">Imaginary</a>, un microservicio encargado de generar las vistas previas de las imágenes subidas a Nextcloud. No es estrictamente necesario, pero es más rápido que la aplicación que tiene Nextcloud para ello.</li></ul><p>Para que Nextcloud empiece a ejecutarse (aunque aun no podamos acceder) simplemente escribimos <code>docker compose up -d</code>.</p><h2 id="configurando-nginx" tabindex="-1">Configurando Nginx <a class="header-anchor" href="#configurando-nginx" aria-label="Permalink to &quot;Configurando Nginx&quot;">​</a></h2><p>Con el <code>docker-compose.yml</code> configurado, podemos pasar a configurar el subdominio para Nextcloud en Nginx. La mayor parte de la configuración la hemos tomado de <a href="https://github.com/nextcloud/docker/blob/master/.examples/docker-compose/insecure/postgres/fpm/web/nginx.conf" target="_blank" rel="noreferrer">este ejemplo</a>, pero añadiendo HTTPS y cambiando unas cuantas cosas. Creamos el archivo <code>/etc/nginx/conf.d/cloud.wupp.dev.conf</code> con el contenido:</p><div class="language-conf"><button title="Copy Code" class="copy"></button><span class="lang">conf</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">upstream nextcloud {</span></span>
<span class="line"><span style="color:#A6ACCD;">    server 127.0.0.1:9000;</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"># Set the `immutable` cache control options only for assets with a cache busting `v` argument</span></span>
<span class="line"><span style="color:#A6ACCD;">map $arg_v $asset_immutable {</span></span>
<span class="line"><span style="color:#A6ACCD;">    &quot;&quot; &quot;&quot;;</span></span>
<span class="line"><span style="color:#A6ACCD;">    default &quot;immutable&quot;;</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">server {</span></span>
<span class="line"><span style="color:#A6ACCD;">    server_name cloud.wupp.dev;</span></span>
<span class="line"><span style="color:#A6ACCD;">    http2 on;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    # set max upload size</span></span>
<span class="line"><span style="color:#A6ACCD;">    client_max_body_size 50G;</span></span>
<span class="line"><span style="color:#A6ACCD;">    # unlimited download speed</span></span>
<span class="line"><span style="color:#A6ACCD;">    limit_rate 0;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    fastcgi_buffers 64 4K;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    # Enable gzip but do not remove ETag headers</span></span>
<span class="line"><span style="color:#A6ACCD;">    gzip on;</span></span>
<span class="line"><span style="color:#A6ACCD;">    gzip_vary on;</span></span>
<span class="line"><span style="color:#A6ACCD;">    gzip_comp_level 4;</span></span>
<span class="line"><span style="color:#A6ACCD;">    gzip_min_length 256;</span></span>
<span class="line"><span style="color:#A6ACCD;">    gzip_proxied expired no-cache no-store private no_last_modified no_etag auth;</span></span>
<span class="line"><span style="color:#A6ACCD;">    gzip_types application/atom+xml application/javascript application/json application/ld+json application/manifest+json application/rss+xml application/vnd.geo+json application/vnd.ms-fontobject application/wasm application/x-font-ttf application/x-web-app-manifest+json application/xhtml+xml application/xml font/opentype image/bmp image/svg+xml image/x-icon text/cache-manifest text/css text/plain text/vcard text/vnd.rim.location.xloc text/vtt text/x-component text/x-cross-domain-policy;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    # The settings allows you to optimize the HTTP2 bandwitdth.</span></span>
<span class="line"><span style="color:#A6ACCD;">    # See https://blog.cloudflare.com/delivering-http-2-upload-speed-improvements/</span></span>
<span class="line"><span style="color:#A6ACCD;">    # for tunning hints</span></span>
<span class="line"><span style="color:#A6ACCD;">    client_body_buffer_size 512k;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    # HTTP response headers</span></span>
<span class="line"><span style="color:#A6ACCD;">    add_header X-Download-Options &quot;noopen&quot; always;</span></span>
<span class="line"><span style="color:#A6ACCD;">    add_header X-Robots-Tag &quot;noindex, nofollow&quot; always;</span></span>
<span class="line"><span style="color:#A6ACCD;">    add_header X-Content-Type-Options nosniff always;</span></span>
<span class="line"><span style="color:#A6ACCD;">    add_header X-Frame-Options &quot;SAMEORIGIN&quot; always;</span></span>
<span class="line"><span style="color:#A6ACCD;">    add_header X-XSS-Protection &quot;1; mode=block&quot; always;</span></span>
<span class="line"><span style="color:#A6ACCD;">    add_header Referrer-Policy &quot;no-referrer&quot; always;</span></span>
<span class="line"><span style="color:#A6ACCD;">    add_header X-Permitted-Cross-Domain-Policies &quot;none&quot; always;</span></span>
<span class="line"><span style="color:#A6ACCD;">    add_header Strict-Transport-Security &quot;max-age=31536000; includeSubDomains; preload&quot;;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    # Add .mjs as a file extension for javascript</span></span>
<span class="line"><span style="color:#A6ACCD;">    # Either include it in the default mime.types list</span></span>
<span class="line"><span style="color:#A6ACCD;">    # or include you can include that list explicitly and add the file extension</span></span>
<span class="line"><span style="color:#A6ACCD;">    # only for Nextcloud like below:</span></span>
<span class="line"><span style="color:#A6ACCD;">    include mime.types;</span></span>
<span class="line"><span style="color:#A6ACCD;">    types {</span></span>
<span class="line"><span style="color:#A6ACCD;">        application/javascript mjs;</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    # Path to the root of your installation</span></span>
<span class="line"><span style="color:#A6ACCD;">    root /var/www/nextcloud;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    # Specify how to handle directories -- specifying `/index.php$request_uri`</span></span>
<span class="line"><span style="color:#A6ACCD;">    # here as the fallback means that Nginx always exhibits the desired behaviour</span></span>
<span class="line"><span style="color:#A6ACCD;">    # when a client requests a path that corresponds to a directory that exists</span></span>
<span class="line"><span style="color:#A6ACCD;">    # on the server. In particular, if that directory contains an index.php file,</span></span>
<span class="line"><span style="color:#A6ACCD;">    # that file is correctly served; if it doesn&#39;t, then the request is passed to</span></span>
<span class="line"><span style="color:#A6ACCD;">    # the front-end controller. This consistent behaviour means that we don&#39;t need</span></span>
<span class="line"><span style="color:#A6ACCD;">    # to specify custom rules for certain paths (e.g. images and other assets,</span></span>
<span class="line"><span style="color:#A6ACCD;">    # `/updater`, `/ocm-provider`, `/ocs-provider`), and thus</span></span>
<span class="line"><span style="color:#A6ACCD;">    # `try_files $uri $uri/ /index.php$request_uri`</span></span>
<span class="line"><span style="color:#A6ACCD;">    # always provides the desired behaviour.</span></span>
<span class="line"><span style="color:#A6ACCD;">    index index.php index.html /index.php$request_uri;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    # Rule borrowed from `.htaccess` to handle Microsoft DAV clients</span></span>
<span class="line"><span style="color:#A6ACCD;">    location = / {</span></span>
<span class="line"><span style="color:#A6ACCD;">        if ( $http_user_agent ~ ^DavClnt ) {</span></span>
<span class="line"><span style="color:#A6ACCD;">            return 302 /remote.php/webdav/$is_args$args;</span></span>
<span class="line"><span style="color:#A6ACCD;">        }</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    location = /robots.txt {</span></span>
<span class="line"><span style="color:#A6ACCD;">        allow all;</span></span>
<span class="line"><span style="color:#A6ACCD;">        log_not_found off;</span></span>
<span class="line"><span style="color:#A6ACCD;">        access_log off;</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    # Make a regex exception for `/.well-known` so that clients can still</span></span>
<span class="line"><span style="color:#A6ACCD;">    # access it despite the existence of the regex rule</span></span>
<span class="line"><span style="color:#A6ACCD;">    # `location ~ /(\.|autotest|...)` which would otherwise handle requests</span></span>
<span class="line"><span style="color:#A6ACCD;">    # for `/.well-known`.</span></span>
<span class="line"><span style="color:#A6ACCD;">    location ^~ /.well-known {</span></span>
<span class="line"><span style="color:#A6ACCD;">        # The rules in this block are an adaptation of the rules</span></span>
<span class="line"><span style="color:#A6ACCD;">        # in `.htaccess` that concern `/.well-known`.</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">        location = /.well-known/carddav { return 301 /remote.php/dav/; }</span></span>
<span class="line"><span style="color:#A6ACCD;">        location = /.well-known/caldav  { return 301 /remote.php/dav/; }</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">        location /.well-known/acme-challenge    { try_files $uri $uri/ =404; }</span></span>
<span class="line"><span style="color:#A6ACCD;">        location /.well-known/pki-validation    { try_files $uri $uri/ =404; }</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">        # Let Nextcloud&#39;s API for `/.well-known` URIs handle all other</span></span>
<span class="line"><span style="color:#A6ACCD;">        # requests by passing them to the front-end controller.</span></span>
<span class="line"><span style="color:#A6ACCD;">        return 301 /index.php$request_uri;</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    # Rules borrowed from `.htaccess` to hide certain paths from clients</span></span>
<span class="line"><span style="color:#A6ACCD;">    location ~ ^/(?:build|tests|config|lib|3rdparty|templates|data)(?:$|/)  { return 404; }</span></span>
<span class="line"><span style="color:#A6ACCD;">    location ~ ^/(?:\.|autotest|occ|issue|indie|db_|console)                { return 404; }</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    # Ensure this block, which passes PHP files to the PHP process, is above the blocks</span></span>
<span class="line"><span style="color:#A6ACCD;">    # which handle static assets (as seen below). If this block is not declared first,</span></span>
<span class="line"><span style="color:#A6ACCD;">    # then Nginx will encounter an infinite rewriting loop when it prepends `/index.php`</span></span>
<span class="line"><span style="color:#A6ACCD;">    # to the URI, resulting in a HTTP 500 error response.</span></span>
<span class="line"><span style="color:#A6ACCD;">    location ~ \.php(?:$|/) {</span></span>
<span class="line"><span style="color:#A6ACCD;">        # Required for legacy support</span></span>
<span class="line"><span style="color:#A6ACCD;">        rewrite ^/(?!index|remote|public|cron|core\/ajax\/update|status|ocs\/v[12]|updater\/.+|oc[ms]-provider\/.+|.+\/richdocumentscode\/proxy) /index.php$request_uri;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">        fastcgi_split_path_info ^(.+?\.php)(/.*)$;</span></span>
<span class="line"><span style="color:#A6ACCD;">        set $path_info $fastcgi_path_info;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">        try_files $fastcgi_script_name =404;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">        include fastcgi_params;</span></span>
<span class="line"><span style="color:#A6ACCD;">        fastcgi_param SCRIPT_FILENAME /var/www/html/$fastcgi_script_name;</span></span>
<span class="line"><span style="color:#A6ACCD;">        fastcgi_param PATH_INFO $path_info;</span></span>
<span class="line"><span style="color:#A6ACCD;">        fastcgi_param HTTPS on;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">        fastcgi_param modHeadersAvailable true;         # Avoid sending the security headers twice</span></span>
<span class="line"><span style="color:#A6ACCD;">        fastcgi_param front_controller_active true;     # Enable pretty urls</span></span>
<span class="line"><span style="color:#A6ACCD;">        fastcgi_pass nextcloud;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">        fastcgi_intercept_errors on;</span></span>
<span class="line"><span style="color:#A6ACCD;">        fastcgi_request_buffering off;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">        fastcgi_max_temp_file_size 0;</span></span>
<span class="line"><span style="color:#A6ACCD;">        fastcgi_read_timeout 600;</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    location ~ \.(?:css|js|svg|gif|png|jpg|ico|wasm|tflite|map)$ {</span></span>
<span class="line"><span style="color:#A6ACCD;">        try_files $uri /index.php$request_uri;</span></span>
<span class="line"><span style="color:#A6ACCD;">        expires 6M;         # Cache-Control policy borrowed from `.htaccess`</span></span>
<span class="line"><span style="color:#A6ACCD;">        access_log off;     # Optional: Don&#39;t log access to assets</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">        location ~ \.wasm$ {</span></span>
<span class="line"><span style="color:#A6ACCD;">            default_type application/wasm;</span></span>
<span class="line"><span style="color:#A6ACCD;">        }</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    location ~ \.woff2?$ {</span></span>
<span class="line"><span style="color:#A6ACCD;">        try_files $uri /index.php$request_uri;</span></span>
<span class="line"><span style="color:#A6ACCD;">        expires 7d;         # Cache-Control policy borrowed from `.htaccess`</span></span>
<span class="line"><span style="color:#A6ACCD;">        access_log off;     # Optional: Don&#39;t log access to assets</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    # Rule borrowed from `.htaccess`</span></span>
<span class="line"><span style="color:#A6ACCD;">    location /remote {</span></span>
<span class="line"><span style="color:#A6ACCD;">        return 301 /remote.php$request_uri;</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    location / {</span></span>
<span class="line"><span style="color:#A6ACCD;">        try_files $uri $uri/ /index.php$request_uri;</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    listen 443 ssl; # managed by Certbot</span></span>
<span class="line"><span style="color:#A6ACCD;">    ssl_certificate /etc/letsencrypt/live/cloud.wupp.dev/fullchain.pem; # managed by Certbot</span></span>
<span class="line"><span style="color:#A6ACCD;">    ssl_certificate_key /etc/letsencrypt/live/cloud.wupp.dev/privkey.pem; # managed by Certbot</span></span>
<span class="line"><span style="color:#A6ACCD;">    include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot</span></span>
<span class="line"><span style="color:#A6ACCD;">    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span></code></pre></div><p>Como puntos a destacar, se ha puesto un límite de cuerpo de 50GB para permitir que se suban archivos de hasta 50G en consonancia con la configuración de <code>docker-compose.yml</code>. Además, se ha quitado el límite de velocidad de transferencia.</p><p>También se vuelven a especificar todas las cabeceras HTTP a pesar de que las pusimos en el bloque <code>http</code> de Nginx, donde está contenido nuestro bloque actual. ¿Por qué? Porque las cabeceras HTTP definidas en un bloque superior solo se heredan al siguiente si en ese no hay ninguna cabecera definida y, en este caso, había que definir sí o sí cabeceras nuevas, así que hay que añadir las que se quieran conservar.</p><p>Por último (y este cambio es puñetero), como PHP se está ejecutando dentro de Docker, para PHP los archivos no están en <code>/var/www/nextcloud</code>, están en <code>/var/www/html</code>, así que hay que cambiarlo en <code>fastcgi_param SCRIPT_FILENAME</code> o, de lo contrario, el servidor solo devolverá un mensaje de &quot;File not found&quot;.</p><p>¡Ojo! Que no se nos olvide generar el certificado HTTPS para el subdominio <code>cloud.wupp.dev</code>. Después, comprobamos que el archivo está bien con <code>sudo nginx -t</code> y si lo está, lo recargamos con <code>sudo nginx -s reload</code>.</p><h2 id="configurando-nextcloud" tabindex="-1">Configurando Nextcloud <a class="header-anchor" href="#configurando-nextcloud" aria-label="Permalink to &quot;Configurando Nextcloud&quot;">​</a></h2><p>Una vez hecho esto, deberíamos de poder acceder a <code>cloud.wupp.dev</code> y nos aparecería la pantalla de configuración inicial de Nexcloud, donde debemos elegir un nombre de usuario y contraseña para la cuenta de administrador. Para la base de datos, elegimos &quot;MySQL/MariaDB&quot; y ponemos el nombre de usuario, contraseña y la base de datos para Nextcloud que pusimos en <code>docker-compose.yml</code>. Por último, para la dirección escribimos <code>nextcloud-db:3306</code>.</p><p>Ya habiendo instalado Nextcloud, podemos navegar por los ajustes y configurarlo, aunque también podemos hacerlo modificando los archivos de configuración como <code>/var/www/nextcloud/config/config.php</code>. Por ejemplo, podemos añadir estas líneas al final:</p><div class="language-php"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">default_language</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">es</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">default_locale</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">es_ES</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">default_phone_region</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ES</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">bulkupload.enabled</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">false,</span></span>
<span class="line"><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">enabledPreviewProviders</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">OC</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Preview</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">TXT</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">OC</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Preview</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">MarkDown</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">OC</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Preview</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">PDF</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">OC</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Preview</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">MSOfficeDoc</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">OC</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Preview</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">JPEG</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">OC</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Preview</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">PNG</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">OC</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Preview</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">GIF</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">OC</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Preview</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">BMP</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">OC</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Preview</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">XBitmap</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">OC</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Preview</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">MP3</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">OC</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Preview</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">HEIC</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">OC</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Preview</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Movie</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">OC</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Preview</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">MKV</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">OC</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Preview</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">MP4</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">OC</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Preview</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">AVI</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">OC</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Preview</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">MP3</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">OC</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Preview</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">OpenDocument</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">OC</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Preview</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Krita</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">OC</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Preview</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Imaginary</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">],</span></span>
<span class="line"><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">preview_imaginary_url</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">http://127.0.0.1:9090</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span></code></pre></div><p>Concretamente, la línea <code>&#39;bulkupload.enabled&#39; =&gt; false,</code> ayuda a solucionar un <a href="https://github.com/nextcloud/desktop/issues/5094" target="_blank" rel="noreferrer">bug</a> que hay actualmente con el cliente de Nextcloud al tener la velocidad de subida ilimitada. Y las últimas líneas son la configuración de Imaginary.</p><p>A parte de eso, como Nextcloud funciona con PHP, nos conviene modificar también la configuración de PHP. Y esto puede ser un poco lioso, porque en la imagen de docker que tenemos hay muchos archivos que modifican la configuración de PHP. Además, esos archivos no los podemos modificar directamente porque al reiniciar el contenedor se borran. La solución es crear un nuevo archivo con las opciones que queremos cambiar y copiarlo dentro del contenedor de docker cada vez que se inicie.</p><p>Para empezar creamos el archivo <code>/var/www/nextcloud/manual-php.ini</code> y ponemos el siguiente contenido:</p><div class="language-ini"><button title="Copy Code" class="copy"></button><span class="lang">ini</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">; Manual configuration for PHP</span></span>
<span class="line"><span style="color:#F07178;">max_input_time</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> -1</span></span>
<span class="line"><span style="color:#F07178;">max_execution_time</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> 172800</span></span>
<span class="line"><span style="color:#F07178;">max_file_uploads</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> 10000</span></span>
<span class="line"><span style="color:#F07178;">max_input_nesting_level</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> 128</span></span>
<span class="line"><span style="color:#F07178;">max_input_vars</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> 10000</span></span></code></pre></div><p>Estos valores se pueden ajustar al gusto de cada uno. Después, solo tendremos que añadir a <code>docker-compose.yml</code> la línea <code>/var/www/nextcloud/manual-php.ini:/usr/local/etc/php/conf.d/manual-php.ini</code> como volumen de Nextcloud y reiniciar los contenedores de docker.</p><p>Finalmente, podemos añadir un poco más de seguridad siguiendo <a href="https://docs.nextcloud.com/server/latest/admin_manual/installation/harden_server.html#setup-fail2ban" target="_blank" rel="noreferrer">estas recomendaciones</a> del manual de Nextcloud.</p></div></div></main><footer class="VPDocFooter" data-v-c4b0d3cf data-v-face870a><!--[--><!--]--><div class="edit-info" data-v-face870a><!----><div class="last-updated" data-v-face870a><p class="VPLastUpdated" data-v-face870a data-v-7b3ebfe1>Actualizado por última vez: <time datetime="2023-06-27T12:33:58.000Z" data-v-7b3ebfe1></time></p></div></div><div class="prev-next" data-v-face870a><div class="pager" data-v-face870a><a class="pager-link prev" href="/server/equipo/mariadb-docker.html" data-v-face870a><span class="desc" data-v-face870a>Previous page</span><span class="title" data-v-face870a>Configurando MariaDB con Docker</span></a></div><div class="has-prev pager" data-v-face870a><a class="pager-link next" href="/server/servicios/minecraft.html" data-v-face870a><span class="desc" data-v-face870a>Next page</span><span class="title" data-v-face870a>Minecraft con AMP</span></a></div></div></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-b2cf3e0b data-v-f7fc41f4><div class="container" data-v-f7fc41f4><p class="message" data-v-f7fc41f4>Distribuido bajo la licencia CC BY.</p><p class="copyright" data-v-f7fc41f4>Copyright © 2022-presente Lucas de Uña Ocampo e Iván Salido Cobo</p></div></footer><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"equipo_gestion-remota.md\":\"4b125541\",\"equipo_hardware.md\":\"a151b407\",\"equipo_router-dominio.md\":\"fbfbd028\",\"shared_servicios_recordatorios-nginx.md\":\"5c804d7b\",\"equipo_sistema-encriptado.md\":\"816e64a2\",\"index.md\":\"d564d798\",\"relatos_usuario-docker.md\":\"66d2748d\",\"servicios_docker-mailserver.md\":\"d6d8d20c\",\"servicios_dozzle.md\":\"4ba16bdc\",\"servicios_gitea.md\":\"f20e76e9\",\"servicios_homarr.md\":\"d6d18ea5\",\"servicios_minecraft.md\":\"54e3610f\",\"relatos_bloqueo-ssh.md\":\"00b1cfc3\",\"servicios_authentik.md\":\"adfd83a2\",\"equipo_docker.md\":\"bd97a541\",\"servicios_navidrome.md\":\"e29fd0ee\",\"equipo_nginx.md\":\"65740c61\",\"servicios_nextcloud.md\":\"8a516859\",\"servicios_sharelatex.md\":\"f2d5d3ee\",\"shared_servicios_puertos.md\":\"ef42af9f\",\"servicios_uptime-kuma.md\":\"c5095fbb\",\"equipo_mariadb-docker.md\":\"44ed2511\"}")
__VP_SITE_DATA__ = JSON.parse("{\"lang\":\"es-ES\",\"dir\":\"ltr\",\"title\":\"Servidor mamadísimo\",\"description\":\"Guía del servidor.\",\"base\":\"/server/\",\"head\":[],\"appearance\":true,\"themeConfig\":{\"lastUpdatedText\":\"Actualizado por última vez\",\"nav\":[{\"text\":\"Inicio\",\"link\":\"/\",\"activeMatch\":\"\"},{\"text\":\"Guía del servidor\",\"link\":\"/equipo/hardware\",\"activeMatch\":\"/(equipo|servicios)/\"},{\"text\":\"Archivos de configuración\",\"link\":\"https://github.com/ComicIvans/server\"}],\"socialLinks\":[{\"icon\":\"discord\",\"link\":\"https://discord.gg/YdnmG5v8\"}],\"sidebar\":{\"/equipo/\":[{\"text\":\"Equipo\",\"collapsible\":true,\"items\":[{\"text\":\"Hardware\",\"link\":\"/equipo/hardware\"},{\"text\":\"Instalación del SO encriptado\",\"link\":\"/equipo/sistema-encriptado\"},{\"text\":\"Configuración del router y dominio\",\"link\":\"/equipo/router-dominio\"},{\"text\":\"Gestión remota con SSH y VNC\",\"link\":\"/equipo/gestion-remota\"},{\"text\":\"Nginx como servidor web\",\"link\":\"/equipo/nginx\"},{\"text\":\"Docker\",\"link\":\"/equipo/docker\"},{\"text\":\"Configurando MariaDB con Docker\",\"link\":\"/equipo/mariadb-docker\"}]},{\"text\":\"Servicios\",\"collapsible\":true,\"items\":[{\"text\":\"Nextcloud - Almacenamiento\",\"link\":\"/servicios/nextcloud\"},{\"text\":\"Minecraft con AMP\",\"link\":\"/servicios/minecraft\"},{\"text\":\"Dozzle - Visualizador de logs\",\"link\":\"/servicios/dozzle\"},{\"text\":\"Homarr - Dashboard\",\"link\":\"/servicios/homarr\"},{\"text\":\"Uptime Kuma - Status\",\"link\":\"/servicios/uptime-kuma\"},{\"text\":\"Authentik - Autenticación\",\"link\":\"/servicios/authentik\"},{\"text\":\"Gitea - Servicio git\",\"link\":\"/servicios/gogs\"},{\"text\":\"Navidrome - Streaming de música\",\"link\":\"/servicios/navidrome\"},{\"text\":\"Overleaf - Editor de LaTeX\",\"link\":\"/servicios/sharelatex\"},{\"text\":\"Docker Mailserver - Servidor de correo\",\"link\":\"/servicios/docker-mailserver\"}]},{\"text\":\"Relatos\",\"collapsible\":true,\"items\":[{\"text\":\"Bloqueo de SSH\",\"link\":\"/relatos/bloqueo-ssh\"},{\"text\":\"Lucas vs. Debian & Docker & etc.\",\"link\":\"/relatos/usuario-docker\"}]}],\"/servicios/\":[{\"text\":\"Equipo\",\"collapsible\":true,\"items\":[{\"text\":\"Hardware\",\"link\":\"/equipo/hardware\"},{\"text\":\"Instalación del SO encriptado\",\"link\":\"/equipo/sistema-encriptado\"},{\"text\":\"Configuración del router y dominio\",\"link\":\"/equipo/router-dominio\"},{\"text\":\"Gestión remota con SSH y VNC\",\"link\":\"/equipo/gestion-remota\"},{\"text\":\"Nginx como servidor web\",\"link\":\"/equipo/nginx\"},{\"text\":\"Docker\",\"link\":\"/equipo/docker\"},{\"text\":\"Configurando MariaDB con Docker\",\"link\":\"/equipo/mariadb-docker\"}]},{\"text\":\"Servicios\",\"collapsible\":true,\"items\":[{\"text\":\"Nextcloud - Almacenamiento\",\"link\":\"/servicios/nextcloud\"},{\"text\":\"Minecraft con AMP\",\"link\":\"/servicios/minecraft\"},{\"text\":\"Dozzle - Visualizador de logs\",\"link\":\"/servicios/dozzle\"},{\"text\":\"Homarr - Dashboard\",\"link\":\"/servicios/homarr\"},{\"text\":\"Uptime Kuma - Status\",\"link\":\"/servicios/uptime-kuma\"},{\"text\":\"Authentik - Autenticación\",\"link\":\"/servicios/authentik\"},{\"text\":\"Gitea - Servicio git\",\"link\":\"/servicios/gogs\"},{\"text\":\"Navidrome - Streaming de música\",\"link\":\"/servicios/navidrome\"},{\"text\":\"Overleaf - Editor de LaTeX\",\"link\":\"/servicios/sharelatex\"},{\"text\":\"Docker Mailserver - Servidor de correo\",\"link\":\"/servicios/docker-mailserver\"}]},{\"text\":\"Relatos\",\"collapsible\":true,\"items\":[{\"text\":\"Bloqueo de SSH\",\"link\":\"/relatos/bloqueo-ssh\"},{\"text\":\"Lucas vs. Debian & Docker & etc.\",\"link\":\"/relatos/usuario-docker\"}]}],\"/relatos/\":[{\"text\":\"Equipo\",\"collapsible\":true,\"items\":[{\"text\":\"Hardware\",\"link\":\"/equipo/hardware\"},{\"text\":\"Instalación del SO encriptado\",\"link\":\"/equipo/sistema-encriptado\"},{\"text\":\"Configuración del router y dominio\",\"link\":\"/equipo/router-dominio\"},{\"text\":\"Gestión remota con SSH y VNC\",\"link\":\"/equipo/gestion-remota\"},{\"text\":\"Nginx como servidor web\",\"link\":\"/equipo/nginx\"},{\"text\":\"Docker\",\"link\":\"/equipo/docker\"},{\"text\":\"Configurando MariaDB con Docker\",\"link\":\"/equipo/mariadb-docker\"}]},{\"text\":\"Servicios\",\"collapsible\":true,\"items\":[{\"text\":\"Nextcloud - Almacenamiento\",\"link\":\"/servicios/nextcloud\"},{\"text\":\"Minecraft con AMP\",\"link\":\"/servicios/minecraft\"},{\"text\":\"Dozzle - Visualizador de logs\",\"link\":\"/servicios/dozzle\"},{\"text\":\"Homarr - Dashboard\",\"link\":\"/servicios/homarr\"},{\"text\":\"Uptime Kuma - Status\",\"link\":\"/servicios/uptime-kuma\"},{\"text\":\"Authentik - Autenticación\",\"link\":\"/servicios/authentik\"},{\"text\":\"Gitea - Servicio git\",\"link\":\"/servicios/gogs\"},{\"text\":\"Navidrome - Streaming de música\",\"link\":\"/servicios/navidrome\"},{\"text\":\"Overleaf - Editor de LaTeX\",\"link\":\"/servicios/sharelatex\"},{\"text\":\"Docker Mailserver - Servidor de correo\",\"link\":\"/servicios/docker-mailserver\"}]},{\"text\":\"Relatos\",\"collapsible\":true,\"items\":[{\"text\":\"Bloqueo de SSH\",\"link\":\"/relatos/bloqueo-ssh\"},{\"text\":\"Lucas vs. Debian & Docker & etc.\",\"link\":\"/relatos/usuario-docker\"}]}]},\"footer\":{\"message\":\"Distribuido bajo la licencia CC BY.\",\"copyright\":\"Copyright © 2022-presente Lucas de Uña Ocampo e Iván Salido Cobo\"}},\"locales\":{},\"scrollOffset\":90,\"cleanUrls\":false}")</script>
    
  </body>
</html>