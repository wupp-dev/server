<!DOCTYPE html>
<html lang="es-ES" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Docker y sus cosas | WUPP</title>
    <meta name="description" content="Guía del servidor.">
    <meta name="generator" content="VitePress v1.5.0">
    <link rel="preload stylesheet" href="/server/assets/style.CJyRZ3hE.css" as="style">
    <link rel="preload stylesheet" href="/server/vp-icons.css" as="style">
    
    <script type="module" src="/server/assets/app.CTD_tMIc.js"></script>
    <link rel="preload" href="/server/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/server/assets/chunks/theme.CVH5M7B8.js">
    <link rel="modulepreload" href="/server/assets/chunks/framework.BXIsVzPz.js">
    <link rel="modulepreload" href="/server/assets/relatos_docker.md.BW0CupdZ.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5d98c3a5><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0f60ec36></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0f60ec36> Skip to content </a><!--]--><!----><header class="VPNav" data-v-5d98c3a5 data-v-ae24b3ad><div class="VPNavBar" data-v-ae24b3ad data-v-6aa21345><div class="wrapper" data-v-6aa21345><div class="container" data-v-6aa21345><div class="title" data-v-6aa21345><div class="VPNavBarTitle has-sidebar" data-v-6aa21345 data-v-1168a8e4><a class="title" href="/server/" data-v-1168a8e4><!--[--><!--]--><!----><span data-v-1168a8e4>WUPP</span><!--[--><!--]--></a></div></div><div class="content" data-v-6aa21345><div class="content-body" data-v-6aa21345><!--[--><!--]--><div class="VPNavBarSearch search" data-v-6aa21345><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-6aa21345 data-v-dc692963><span id="main-nav-aria-label" class="visually-hidden" data-v-dc692963> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/server/" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>Inicio</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/server/equipo/historia.html" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>Guía del servidor</span><!--]--></a><!--]--><!--[--><a class="VPLink link vp-external-link-icon VPNavBarMenuLink" href="https://github.com/wupp-dev/server" target="_blank" rel="noreferrer" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>Archivos de configuración</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-6aa21345 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-6aa21345 data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://discord.gg/2pdbaf6Ugz" aria-label="discord" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-discord"></span></a><a class="VPSocialLink no-icon" href="https://github.com/wupp-dev/" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-6aa21345 data-v-bb2aa2f0 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-cf11d7a2><span class="vpi-more-horizontal icon" data-v-cf11d7a2></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><!----><!--[--><!--[--><!----><div class="group" data-v-bb2aa2f0><div class="item appearance" data-v-bb2aa2f0><p class="label" data-v-bb2aa2f0>Appearance</p><div class="appearance-action" data-v-bb2aa2f0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bb2aa2f0 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bb2aa2f0><div class="item social-links" data-v-bb2aa2f0><div class="VPSocialLinks social-links-list" data-v-bb2aa2f0 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://discord.gg/2pdbaf6Ugz" aria-label="discord" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-discord"></span></a><a class="VPSocialLink no-icon" href="https://github.com/wupp-dev/" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-6aa21345 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-6aa21345><div class="divider-line" data-v-6aa21345></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-5d98c3a5 data-v-a6f0e41e><div class="container" data-v-a6f0e41e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-a6f0e41e><span class="vpi-align-left menu-icon" data-v-a6f0e41e></span><span class="menu-text" data-v-a6f0e41e>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a6f0e41e data-v-17a5e62e><button data-v-17a5e62e>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-5d98c3a5 data-v-319d5ca6><div class="curtain" data-v-319d5ca6></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-319d5ca6><span class="visually-hidden" id="sidebar-aria-label" data-v-319d5ca6> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0" data-v-c40bc020 data-v-b7550ba0><div class="item" role="button" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><h2 class="text" data-v-b7550ba0>Equipo</h2><!----></div><div class="items" data-v-b7550ba0><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/server/equipo/historia.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Historia</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/server/equipo/hardware.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Hardware</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/server/equipo/sistema-encriptado.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Instalación del SO encriptado</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/server/equipo/router-dominio.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Configuración del router y dominio</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/server/equipo/gestion-remota.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Gestión remota con SSH y VNC</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/server/equipo/nginx.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Nginx como servidor web</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/server/equipo/docker.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Docker</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/server/equipo/mariadb-docker.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Configurando MariaDB con Docker</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/server/equipo/monitorizacion.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Monitorizando el equipo y los servicios</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/server/equipo/conectando-servidores.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Conectando varios servidores</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0" data-v-c40bc020 data-v-b7550ba0><div class="item" role="button" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><h2 class="text" data-v-b7550ba0>Servicios</h2><!----></div><div class="items" data-v-b7550ba0><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/server/servicios/nextcloud.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Nextcloud - Almacenamiento</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/server/servicios/mailserver.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Docker Mailserver - Correo electrónico</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/server/servicios/minio.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Minio - Almacenamiento S3</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/server/servicios/minecraft.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Minecraft con AMP</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/server/servicios/dozzle.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Dozzle - Visualizador de logs</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/server/servicios/homarr.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Homarr - Dashboard</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/server/servicios/uptime-kuma.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Uptime Kuma - Status</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/server/servicios/authentik.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Authentik - Autenticación</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/server/servicios/gogs.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Gitea - Servicio git</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/server/servicios/navidrome.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Navidrome - Streaming de música</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/server/servicios/sharelatex.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Overleaf - Editor de LaTeX</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0 has-active" data-v-c40bc020 data-v-b7550ba0><div class="item" role="button" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><h2 class="text" data-v-b7550ba0>Relatos</h2><!----></div><div class="items" data-v-b7550ba0><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/server/relatos/bloqueo-ssh.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Bloqueo de SSH</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/server/relatos/docker.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Docker y sus cosas</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/server/relatos/dns-initramfs.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Resolución de dominios en initramfs</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/server/relatos/tunel-ssh-ulp.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Túnel SSH en la UGR LAN Party de 2024</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-5d98c3a5 data-v-1428d186><div class="VPDoc has-sidebar has-aside" data-v-1428d186 data-v-39a288b8><!--[--><!--]--><div class="container" data-v-39a288b8><div class="aside" data-v-39a288b8><div class="aside-curtain" data-v-39a288b8></div><div class="aside-container" data-v-39a288b8><div class="aside-content" data-v-39a288b8><div class="VPDocAside" data-v-39a288b8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-a5bbad30><div class="content" data-v-a5bbad30><div class="outline-marker" data-v-a5bbad30></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-a5bbad30>On this page</div><ul class="VPDocOutlineItem root" data-v-a5bbad30 data-v-b933a997><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-39a288b8><div class="content-container" data-v-39a288b8><!--[--><!--]--><main class="main" data-v-39a288b8><div style="position:relative;" class="vp-doc _server_relatos_docker" data-v-39a288b8><div><h1 id="docker-y-sus-cosas" tabindex="-1">Docker y sus cosas <a class="header-anchor" href="#docker-y-sus-cosas" aria-label="Permalink to &quot;Docker y sus cosas&quot;">​</a></h1><p>Inicialmente, este relato viene de intentar instalar Docker que y Debian decidiese que no lo iba a hacer, pero tras una larga meditación y que Docker no funcione muchas veces porque porqué no, he decidido que puedo incluir aquí todas esas anécdotas de cuando Docker no es maravilloso.</p><h2 id="instalacion-de-docker" tabindex="-1">Instalación de Docker <a class="header-anchor" href="#instalacion-de-docker" aria-label="Permalink to &quot;Instalación de Docker&quot;">​</a></h2><p>Sorprendentemente, fué bien, sin problema.</p><h2 id="vamos-a-crear-el-usuario-docker" tabindex="-1">Vamos a crear el usuario <em>docker</em> <a class="header-anchor" href="#vamos-a-crear-el-usuario-docker" aria-label="Permalink to &quot;Vamos a crear el usuario _docker_&quot;">​</a></h2><p>Aquí Debian dijo: ª.</p><p>Lo primero fué ejecutar <code>sudo adduser -m docker</code>, que es lo que indica cualquier guía para crear un usuario con Debian y otras distros y, hasta donde mi memoria llega, es el comando que había ejecutado yo previamente para esas tareas. Pero esta ejecución fallaba y decía lo siguiente: <code>Unknown option: m</code>. Viendo la ayuda del comando con <code>sudo adduser --help</code> y <code>man adduser</code>, pues no estaba la opción <code>-m</code>, entonces procedí a crearlo sin la opción a ver si funcionaba.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>En un principio, la opción <code>-m</code> en <code>adduser</code> indica al comando que cree la carpeta <em>home</em> del usuario en <em>/home/&lt;username&gt;</em> (o donde se indique con la opción <code>-D</code>).</p></div><p>Al ejecutar <code>sudo adduser docker</code>, el comando fallaba y devolvía el siguiente error: <code>adduser: El grupo &#39;docker&#39; ya existe.</code>. Y pues claro, mi respuesta inicial fué que yo estaba intentando crear un usuario, no un grupo. Me gustaría poder decir que me di cuenta de que al crear un usuario se creaba un grupo con el mismo nombre, pero eso no sería cierto, sino que mi compañero Iván lo descubrió cuando esto ya estaba solucionado. Básicamente mi solución fue crear un usuario con otro nombre, en este caso hice <code>sudo adduser dockeruser</code>, y funcionó.</p><p>Ahora procedí a comprobar la existencia de <em>/home/dockeruser</em> y correcto, existía, y los permisos estaban correctamente configurados así que perfecto. Procedo a ver los usuarios que existen con <code>awk -F: &#39;{ print $1}&#39; /etc/passwd | grep docker</code> y ¡sorpresa!, no aparece el usuario.</p><p>Entonces yo que se me veía muy despierto ese día, vuelvo a buscar por internet y descubro que claro, tenía que asignarle una contraseña al usuario con <code>sudo passwd dockeruser</code> y ya estaba todo bien.</p><div class="tip custom-block"><p class="custom-block-title">RECOMENDACIÓN</p><p>Contraseñas largas para los usuarios por favor y gracias</p></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Normalmente las herramientas base del sistema de Debian y todas estas distros, GNU utils vamos, no suelen cambiar la API, así que realmente desconozco por completo que ha podido ocurrir con <code>adduser</code> para que no me funcionase una opción que se supone que existe.</p></div><h2 id="nos-queda-crear-el-grupo" tabindex="-1">Nos queda crear el grupo <a class="header-anchor" href="#nos-queda-crear-el-grupo" aria-label="Permalink to &quot;Nos queda crear el grupo&quot;">​</a></h2><p>Por si crear el usuario no hubiese sido ya difícil, toca gestionar el añadir el usuario al grupo de Docker. Quiero que veáis lo que pone en la documentación oficial de Docker antes de nada:</p><p><img src="/server/assets/docker-group.CpZMK0fx.png" alt="sudo groupadd docker"></p><p>Se puede observar que Docker te dice que crees el grupo <em>docker</em>. Pues procedo a crear el grupo docker con <code>sudo groupadd docker</code> y obtengo lo siguiente (después de entender por qué fallaba lo del usuario, esto tiene lógica): <code>groupadd: group &#39;docker&#39; already exists</code>.</p><p>Así que lo dicho, lo que ocurrió es que al <strong>contrario de lo que dice la documentación oficial de Docker</strong>, el grupo <em>docker</em> ya se crea al instalar Docker y por tanto no es necesario crearlo, solo añadir el resultado con <code>sudo usermod -aG docker dockeruser</code>.</p><h2 id="secrets-¿funcionaran-o-no" tabindex="-1">Secrets: ¿funcionarán o no? <a class="header-anchor" href="#secrets-¿funcionaran-o-no" aria-label="Permalink to &quot;Secrets: ¿funcionarán o no?&quot;">​</a></h2><p>De cuando los <code>secret: external: true</code> no fué</p><h2 id="resolviendo-urls-a-su-manera" tabindex="-1">Resolviendo URLs a su manera <a class="header-anchor" href="#resolviendo-urls-a-su-manera" aria-label="Permalink to &quot;Resolviendo URLs a su manera&quot;">​</a></h2><p>Probando de manera local Grafana, seguí la configuración lógica y recomendada para una instalación completamente local, es decir usando <code>http://localhost:9090</code> para conectar con Prometheus. Y resulta que a Grafana no le gustó la idea, prefirió no conectarse.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Grafana al ir a guardar comprueba la condición, concretamente utilizando la dirección <code>&lt;URL_INDICADA&gt;/api/v1/query</code>. Igual os tenta a decir <em>&quot;Bueno voy a acceder a la dirección desde el navegador a ver que pasa&quot;</em>. Ya os adelanto que os va a dar un error, pero ese no es el error, simplemente que Grafana está llamando a esa dirección de otra forma. Empezamos bien.</p></div><p>Me puse por tanto a investigar. Lo primero es cambiar <code>localhost</code> por, por ejemplo, la IP del ordenador. Igual te preguntarás que qué cambia esto.</p><p>Resulta que al parecer Docker, cuando indicas <code>locahost</code> en una URL que se resuleve dentro del contenedor, se refiere al propio contenedor. ¿Me había dado alguna vez este problema? Pues no, pero bueno ahora sí. Por tanto, cambiamos esto por la IP.</p><p>Tampoco funciona. Ahora ya si que desconozco completamente el porqué, dado que el puerto estaba expuesto. Para resolverlo, podemos utilizar la <strong>IP del contenedor</strong>.</p><p>Para esto, utilizamos <code>docker network inspect &lt;NETWORK_NAME&gt;</code>, lo cual nos dará una salida en JSON tal que así, en la que lo que queremos es el campo <code>IPv4Addres</code> de nuestro contenedor de Prometheus:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;Name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&lt;NETWORK_NAME&gt;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ...</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;Containers&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // ...</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;dab612af78aad409569df2dba82a4b4eb5fba7f112e678834c091334a52be3b2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;Name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;prometheus-1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;EndpointID&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;fea6ee17f8403a1de08769a602bd8175bdc7fdr6a23983a49bc0b5f7bf1994e1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;MacAddress&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;02:42:ac:14:00:03&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;IPv4Address&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;172.20.0.3/16&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;IPv6Address&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div><p>Ahora, si en Grafana reemplazamos <code>localhost</code> por <code>172.20.0.3</code> (ignorando lo que hay después de la <code>/</code>), ¡ya funciona! Esto se debe a que esa dirección IPv4 es la del contenedor en la red aislada que monta Docker, por tanto estamos accediendo al contenedor de Prometheus directamente.</p><p>¿Debería de haber funcionado poniendo <code>localhost</code> por que estamos exponiendo el puerto? Sí. ¿Por qué no lo hace? Buena pregunta. Si en algún momento lo descubro, aquí veréis la respuesta.</p></div></div></main><footer class="VPDocFooter" data-v-39a288b8 data-v-e257564d><!--[--><!--]--><div class="edit-info" data-v-e257564d><!----><div class="last-updated" data-v-e257564d><p class="VPLastUpdated" data-v-e257564d data-v-e98dd255>Actualizado por última vez: <time datetime="2025-01-14T20:04:12.000Z" data-v-e98dd255></time></p></div></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-e257564d><span class="visually-hidden" id="doc-footer-aria-label" data-v-e257564d>Pager</span><div class="pager" data-v-e257564d><a class="VPLink link pager-link prev" href="/server/relatos/bloqueo-ssh.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Previous page</span><span class="title" data-v-e257564d>Bloqueo de SSH</span><!--]--></a></div><div class="pager" data-v-e257564d><a class="VPLink link pager-link next" href="/server/relatos/dns-initramfs.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Next page</span><span class="title" data-v-e257564d>Resolución de dominios en initramfs</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-5d98c3a5 data-v-e315a0ad><div class="container" data-v-e315a0ad><p class="message" data-v-e315a0ad>Distribuido bajo la licencia CC BY.</p><p class="copyright" data-v-e315a0ad>Copyright © 2022-presente Lucas de Uña Ocampo e Iván Salido Cobo</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"equipo_conectando-servidores.md\":\"Djv22cFZ\",\"equipo_docker.md\":\"DHuCnmDG\",\"equipo_gestion-remota.md\":\"CvGgw0Zg\",\"equipo_hardware.md\":\"CuHXB7OU\",\"equipo_historia.md\":\"DVzKbW9n\",\"equipo_mariadb-docker.md\":\"D7udNzdj\",\"equipo_monitorizacion.md\":\"BvRvslNo\",\"equipo_nginx.md\":\"6byzJdTd\",\"equipo_router-dominio.md\":\"6xLKVScC\",\"equipo_sistema-encriptado.md\":\"Bosouecv\",\"index.md\":\"BhHnS7uM\",\"relatos_bloqueo-ssh.md\":\"DYSHIBsb\",\"relatos_dns-initramfs.md\":\"Bt9Pz5ZT\",\"relatos_docker.md\":\"BW0CupdZ\",\"relatos_tunel-ssh-ulp.md\":\"D1NAIsTT\",\"servicios_authentik.md\":\"BuR521wF\",\"servicios_dozzle.md\":\"WNmbRuRF\",\"servicios_gitea.md\":\"B2aPkNoh\",\"servicios_homarr.md\":\"BA1XGhcj\",\"servicios_mailserver.md\":\"BXfSyi3m\",\"servicios_minecraft.md\":\"DZdkrcr0\",\"servicios_minio.md\":\"gYEeCe_U\",\"servicios_navidrome.md\":\"CoqbUAjO\",\"servicios_nextcloud.md\":\"D7F8--wL\",\"servicios_sharelatex.md\":\"fqtFmvhQ\",\"servicios_uptime-kuma.md\":\"BKbbQJXr\",\"shared_servicios_puertos.md\":\"BvSSUJaQ\",\"shared_servicios_recordatorios-nginx.md\":\"BISQ13KB\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"es-ES\",\"dir\":\"ltr\",\"title\":\"WUPP\",\"description\":\"Guía del servidor.\",\"base\":\"/server/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"lastUpdatedText\":\"Actualizado por última vez\",\"nav\":[{\"text\":\"Inicio\",\"link\":\"/\",\"activeMatch\":\"\"},{\"text\":\"Guía del servidor\",\"link\":\"/equipo/historia\",\"activeMatch\":\"/(equipo|servicios)/\"},{\"text\":\"Archivos de configuración\",\"link\":\"https://github.com/wupp-dev/server\"}],\"socialLinks\":[{\"icon\":\"discord\",\"link\":\"https://discord.gg/2pdbaf6Ugz\"},{\"icon\":\"github\",\"link\":\"https://github.com/wupp-dev/\"}],\"sidebar\":{\"/equipo/\":[{\"text\":\"Equipo\",\"collapsible\":true,\"items\":[{\"text\":\"Historia\",\"link\":\"/equipo/historia\"},{\"text\":\"Hardware\",\"link\":\"/equipo/hardware\"},{\"text\":\"Instalación del SO encriptado\",\"link\":\"/equipo/sistema-encriptado\"},{\"text\":\"Configuración del router y dominio\",\"link\":\"/equipo/router-dominio\"},{\"text\":\"Gestión remota con SSH y VNC\",\"link\":\"/equipo/gestion-remota\"},{\"text\":\"Nginx como servidor web\",\"link\":\"/equipo/nginx\"},{\"text\":\"Docker\",\"link\":\"/equipo/docker\"},{\"text\":\"Configurando MariaDB con Docker\",\"link\":\"/equipo/mariadb-docker\"},{\"text\":\"Monitorizando el equipo y los servicios\",\"link\":\"/equipo/monitorizacion\"},{\"text\":\"Conectando varios servidores\",\"link\":\"/equipo/conectando-servidores\"}]},{\"text\":\"Servicios\",\"collapsible\":true,\"items\":[{\"text\":\"Nextcloud - Almacenamiento\",\"link\":\"/servicios/nextcloud\"},{\"text\":\"Docker Mailserver - Correo electrónico\",\"link\":\"/servicios/mailserver\"},{\"text\":\"Minio - Almacenamiento S3\",\"link\":\"/servicios/minio\"},{\"text\":\"Minecraft con AMP\",\"link\":\"/servicios/minecraft\"},{\"text\":\"Dozzle - Visualizador de logs\",\"link\":\"/servicios/dozzle\"},{\"text\":\"Homarr - Dashboard\",\"link\":\"/servicios/homarr\"},{\"text\":\"Uptime Kuma - Status\",\"link\":\"/servicios/uptime-kuma\"},{\"text\":\"Authentik - Autenticación\",\"link\":\"/servicios/authentik\"},{\"text\":\"Gitea - Servicio git\",\"link\":\"/servicios/gogs\"},{\"text\":\"Navidrome - Streaming de música\",\"link\":\"/servicios/navidrome\"},{\"text\":\"Overleaf - Editor de LaTeX\",\"link\":\"/servicios/sharelatex\"}]},{\"text\":\"Relatos\",\"collapsible\":true,\"items\":[{\"text\":\"Bloqueo de SSH\",\"link\":\"/relatos/bloqueo-ssh\"},{\"text\":\"Docker y sus cosas\",\"link\":\"/relatos/docker\"},{\"text\":\"Resolución de dominios en initramfs\",\"link\":\"/relatos/dns-initramfs\"},{\"text\":\"Túnel SSH en la UGR LAN Party de 2024\",\"link\":\"/relatos/tunel-ssh-ulp\"}]}],\"/servicios/\":[{\"text\":\"Equipo\",\"collapsible\":true,\"items\":[{\"text\":\"Historia\",\"link\":\"/equipo/historia\"},{\"text\":\"Hardware\",\"link\":\"/equipo/hardware\"},{\"text\":\"Instalación del SO encriptado\",\"link\":\"/equipo/sistema-encriptado\"},{\"text\":\"Configuración del router y dominio\",\"link\":\"/equipo/router-dominio\"},{\"text\":\"Gestión remota con SSH y VNC\",\"link\":\"/equipo/gestion-remota\"},{\"text\":\"Nginx como servidor web\",\"link\":\"/equipo/nginx\"},{\"text\":\"Docker\",\"link\":\"/equipo/docker\"},{\"text\":\"Configurando MariaDB con Docker\",\"link\":\"/equipo/mariadb-docker\"},{\"text\":\"Monitorizando el equipo y los servicios\",\"link\":\"/equipo/monitorizacion\"},{\"text\":\"Conectando varios servidores\",\"link\":\"/equipo/conectando-servidores\"}]},{\"text\":\"Servicios\",\"collapsible\":true,\"items\":[{\"text\":\"Nextcloud - Almacenamiento\",\"link\":\"/servicios/nextcloud\"},{\"text\":\"Docker Mailserver - Correo electrónico\",\"link\":\"/servicios/mailserver\"},{\"text\":\"Minio - Almacenamiento S3\",\"link\":\"/servicios/minio\"},{\"text\":\"Minecraft con AMP\",\"link\":\"/servicios/minecraft\"},{\"text\":\"Dozzle - Visualizador de logs\",\"link\":\"/servicios/dozzle\"},{\"text\":\"Homarr - Dashboard\",\"link\":\"/servicios/homarr\"},{\"text\":\"Uptime Kuma - Status\",\"link\":\"/servicios/uptime-kuma\"},{\"text\":\"Authentik - Autenticación\",\"link\":\"/servicios/authentik\"},{\"text\":\"Gitea - Servicio git\",\"link\":\"/servicios/gogs\"},{\"text\":\"Navidrome - Streaming de música\",\"link\":\"/servicios/navidrome\"},{\"text\":\"Overleaf - Editor de LaTeX\",\"link\":\"/servicios/sharelatex\"}]},{\"text\":\"Relatos\",\"collapsible\":true,\"items\":[{\"text\":\"Bloqueo de SSH\",\"link\":\"/relatos/bloqueo-ssh\"},{\"text\":\"Docker y sus cosas\",\"link\":\"/relatos/docker\"},{\"text\":\"Resolución de dominios en initramfs\",\"link\":\"/relatos/dns-initramfs\"},{\"text\":\"Túnel SSH en la UGR LAN Party de 2024\",\"link\":\"/relatos/tunel-ssh-ulp\"}]}],\"/relatos/\":[{\"text\":\"Equipo\",\"collapsible\":true,\"items\":[{\"text\":\"Historia\",\"link\":\"/equipo/historia\"},{\"text\":\"Hardware\",\"link\":\"/equipo/hardware\"},{\"text\":\"Instalación del SO encriptado\",\"link\":\"/equipo/sistema-encriptado\"},{\"text\":\"Configuración del router y dominio\",\"link\":\"/equipo/router-dominio\"},{\"text\":\"Gestión remota con SSH y VNC\",\"link\":\"/equipo/gestion-remota\"},{\"text\":\"Nginx como servidor web\",\"link\":\"/equipo/nginx\"},{\"text\":\"Docker\",\"link\":\"/equipo/docker\"},{\"text\":\"Configurando MariaDB con Docker\",\"link\":\"/equipo/mariadb-docker\"},{\"text\":\"Monitorizando el equipo y los servicios\",\"link\":\"/equipo/monitorizacion\"},{\"text\":\"Conectando varios servidores\",\"link\":\"/equipo/conectando-servidores\"}]},{\"text\":\"Servicios\",\"collapsible\":true,\"items\":[{\"text\":\"Nextcloud - Almacenamiento\",\"link\":\"/servicios/nextcloud\"},{\"text\":\"Docker Mailserver - Correo electrónico\",\"link\":\"/servicios/mailserver\"},{\"text\":\"Minio - Almacenamiento S3\",\"link\":\"/servicios/minio\"},{\"text\":\"Minecraft con AMP\",\"link\":\"/servicios/minecraft\"},{\"text\":\"Dozzle - Visualizador de logs\",\"link\":\"/servicios/dozzle\"},{\"text\":\"Homarr - Dashboard\",\"link\":\"/servicios/homarr\"},{\"text\":\"Uptime Kuma - Status\",\"link\":\"/servicios/uptime-kuma\"},{\"text\":\"Authentik - Autenticación\",\"link\":\"/servicios/authentik\"},{\"text\":\"Gitea - Servicio git\",\"link\":\"/servicios/gogs\"},{\"text\":\"Navidrome - Streaming de música\",\"link\":\"/servicios/navidrome\"},{\"text\":\"Overleaf - Editor de LaTeX\",\"link\":\"/servicios/sharelatex\"}]},{\"text\":\"Relatos\",\"collapsible\":true,\"items\":[{\"text\":\"Bloqueo de SSH\",\"link\":\"/relatos/bloqueo-ssh\"},{\"text\":\"Docker y sus cosas\",\"link\":\"/relatos/docker\"},{\"text\":\"Resolución de dominios en initramfs\",\"link\":\"/relatos/dns-initramfs\"},{\"text\":\"Túnel SSH en la UGR LAN Party de 2024\",\"link\":\"/relatos/tunel-ssh-ulp\"}]}]},\"footer\":{\"message\":\"Distribuido bajo la licencia CC BY.\",\"copyright\":\"Copyright © 2022-presente Lucas de Uña Ocampo e Iván Salido Cobo\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>