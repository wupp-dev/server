<!DOCTYPE html>
<html lang="es-ES">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Instalación del SO encriptado | Servidor mamadísimo</title>
    <meta name="description" content="Guía del servidor.">
    <link rel="stylesheet" href="/server/assets/style.06d278ee.css">
    <link rel="modulepreload" href="/server/assets/app.bf15efc8.js">
    <link rel="modulepreload" href="/server/assets/equipo_sistema-encriptado.md.7345a3e3.lean.js">
    
    <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance"),a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-ca9ccb7e><!--[--><!--]--><!--[--><span tabindex="-1" data-v-151f2593></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-151f2593> Skip to content </a><!--]--><!----><header class="VPNav" data-v-ca9ccb7e data-v-a71a30f1><div class="VPNavBar has-sidebar" data-v-a71a30f1 data-v-a35e6f52><div class="container" data-v-a35e6f52><div class="VPNavBarTitle has-sidebar" data-v-a35e6f52 data-v-d5925166><a class="title" href="/server/" data-v-d5925166><!--[--><!--]--><!----><!--[-->Servidor mamadísimo<!--]--><!--[--><!--]--></a></div><div class="content" data-v-a35e6f52><!--[--><!--]--><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-a35e6f52 data-v-f83db6ba><span id="main-nav-aria-label" class="visually-hidden" data-v-f83db6ba>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/server/" data-v-f83db6ba data-v-47a2263e data-v-3c355974><!--[-->Inicio<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/server/equipo/hardware.html" data-v-f83db6ba data-v-47a2263e data-v-3c355974><!--[-->Guía del servidor<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="https://github.com/ComicIvans/server" target="_blank" rel="noreferrer" data-v-f83db6ba data-v-47a2263e data-v-3c355974><!--[-->Archivos de configuración<!--]--><!----></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-a35e6f52 data-v-a3e7452b><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" data-v-a3e7452b data-v-968780f1 data-v-086e8519><span class="check" data-v-086e8519><span class="icon" data-v-086e8519><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-968780f1><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-968780f1><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-a35e6f52 data-v-738bef5a data-v-f6988cfb><!--[--><a class="VPSocialLink" href="https://discord.gg/YdnmG5v8" target="_blank" rel="noopener" data-v-f6988cfb data-v-e57698f6><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Discord</title><path d="M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.4189-2.1568 2.4189Z"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-a35e6f52 data-v-e89b88d7 data-v-6ffb57d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-6ffb57d3><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-6ffb57d3><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-6ffb57d3><div class="VPMenu" data-v-6ffb57d3 data-v-1c5d0cfc><!----><!--[--><!--[--><!----><div class="group" data-v-e89b88d7><div class="item appearance" data-v-e89b88d7><p class="label" data-v-e89b88d7>Appearance</p><div class="appearance-action" data-v-e89b88d7><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" data-v-e89b88d7 data-v-968780f1 data-v-086e8519><span class="check" data-v-086e8519><span class="icon" data-v-086e8519><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-968780f1><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-968780f1><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-e89b88d7><div class="item social-links" data-v-e89b88d7><div class="VPSocialLinks social-links-list" data-v-e89b88d7 data-v-f6988cfb><!--[--><a class="VPSocialLink" href="https://discord.gg/YdnmG5v8" target="_blank" rel="noopener" data-v-f6988cfb data-v-e57698f6><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Discord</title><path d="M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.4189-2.1568 2.4189Z"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-a35e6f52 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div><!----></header><div class="VPLocalNav" data-v-ca9ccb7e data-v-aac27d5e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-aac27d5e><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-aac27d5e><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-aac27d5e>Menu</span></button><a class="top-link" href="#" data-v-aac27d5e> Return to top </a></div><aside class="VPSidebar" data-v-ca9ccb7e data-v-f332cb62><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-f332cb62><span class="visually-hidden" id="sidebar-aria-label" data-v-f332cb62> Sidebar Navigation </span><!--[--><div class="group" data-v-f332cb62><section class="VPSidebarGroup collapsible" data-v-f332cb62 data-v-2976c796><div class="title" role="button" data-v-2976c796><h2 class="title-text" data-v-2976c796>Equipo</h2><div class="action" data-v-2976c796><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-2976c796><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-2976c796><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-2976c796><!--[--><a class="VPLink link link" href="/server/equipo/hardware.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Hardware</span><!----><!--]--><!----></a><a class="VPLink link link active" href="/server/equipo/sistema-encriptado.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Instalación del SO encriptado</span><!----><!--]--><!----></a><a class="VPLink link link" href="/server/equipo/router-dominio.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Configuración del router y dominio</span><!----><!--]--><!----></a><a class="VPLink link link" href="/server/equipo/gestion-remota.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Gestión remota con SSH y VNC</span><!----><!--]--><!----></a><a class="VPLink link link" href="/server/equipo/nginx.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Nginx como servidor web</span><!----><!--]--><!----></a><a class="VPLink link link" href="/server/equipo/docker.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Docker</span><!----><!--]--><!----></a><a class="VPLink link link" href="/server/equipo/mariadb-docker.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Configurando MariaDB con Docker</span><!----><!--]--><!----></a><!--]--></div></section></div><div class="group" data-v-f332cb62><section class="VPSidebarGroup collapsible" data-v-f332cb62 data-v-2976c796><div class="title" role="button" data-v-2976c796><h2 class="title-text" data-v-2976c796>Servicios</h2><div class="action" data-v-2976c796><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-2976c796><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-2976c796><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-2976c796><!--[--><a class="VPLink link link" href="/server/servicios/minecraft.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Minecraft con AMP</span><!----><!--]--><!----></a><a class="VPLink link link" href="/server/servicios/dozzle.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Dozzle - Visualizador de logs</span><!----><!--]--><!----></a><a class="VPLink link link" href="/server/servicios/homarr.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Homarr - Dashboard</span><!----><!--]--><!----></a><a class="VPLink link link" href="/server/servicios/uptime-kuma.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Uptime Kuma - Status</span><!----><!--]--><!----></a><a class="VPLink link link" href="/server/servicios/authentik.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Authentik - Autenticación</span><!----><!--]--><!----></a><a class="VPLink link link" href="/server/servicios/nextcloud.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Nextcloud - Almacenamiento</span><!----><!--]--><!----></a><a class="VPLink link link" href="/server/servicios/gogs.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Gitea - Servicio git</span><!----><!--]--><!----></a><!--]--></div></section></div><div class="group" data-v-f332cb62><section class="VPSidebarGroup collapsible" data-v-f332cb62 data-v-2976c796><div class="title" role="button" data-v-2976c796><h2 class="title-text" data-v-2976c796>Relatos</h2><div class="action" data-v-2976c796><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-2976c796><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-2976c796><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-2976c796><!--[--><a class="VPLink link link" href="/server/relatos/initramfs-vs-router.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Initramfs vs Router</span><!----><!--]--><!----></a><a class="VPLink link link" href="/server/relatos/bloqueo-ssh.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Bloqueo de SSH</span><!----><!--]--><!----></a><a class="VPLink link link" href="/server/relatos/usuario-docker.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Lucas vs. Debian &amp; Docker &amp; etc.</span><!----><!--]--><!----></a><!--]--></div></section></div><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-ca9ccb7e data-v-c95df128><div class="VPDoc has-sidebar has-aside" data-v-c95df128 data-v-f0af2311><div class="container" data-v-f0af2311><div class="aside" data-v-f0af2311><div class="aside-curtain" data-v-f0af2311></div><div class="aside-container" data-v-f0af2311><div class="aside-content" data-v-f0af2311><div class="VPDocAside" data-v-f0af2311 data-v-aea49c31><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline has-outline" data-v-aea49c31 data-v-a3de185c><div class="content" data-v-a3de185c><div class="outline-marker" data-v-a3de185c></div><div class="outline-title" data-v-a3de185c>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-a3de185c><span class="visually-hidden" id="doc-outline-aria-label" data-v-a3de185c> Table of Contents for current page </span><ul class="root" data-v-a3de185c><!--[--><li data-v-a3de185c><a class="outline-link" href="#escogiendo-y-descargando-el-sistema-operativo" data-v-a3de185c>Escogiendo y descargando el sistema operativo.</a><!----></li><li data-v-a3de185c><a class="outline-link" href="#configuracion-de-la-bios-del-servidor" data-v-a3de185c>Configuración de la BIOS del servidor</a><!----></li><li data-v-a3de185c><a class="outline-link" href="#instalacion-de-debian-11" data-v-a3de185c>Instalación de Debian 11</a><!----></li><li data-v-a3de185c><a class="outline-link" href="#configuracion-basica-y-pequenas-mejoras" data-v-a3de185c>Configuración básica y pequeñas mejoras</a><!----></li><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-aea49c31></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-f0af2311><div class="content-container" data-v-f0af2311><!--[--><!--]--><main class="main" data-v-f0af2311><div style="position:relative;" class="vp-doc _server_equipo_sistema-encriptado" data-v-f0af2311><div><h1 id="instalacion-del-so-encriptado" tabindex="-1">Instalación del SO encriptado <a class="header-anchor" href="#instalacion-del-so-encriptado" aria-hidden="true">#</a></h1><p>Vamos a darle vida al cacharro ese que se hace llamar servidor. En esta sección instalaremos el sistema operativo con los discos encriptados y haremos un poco de configuración básica.</p><h2 id="escogiendo-y-descargando-el-sistema-operativo" tabindex="-1">Escogiendo y descargando el sistema operativo. <a class="header-anchor" href="#escogiendo-y-descargando-el-sistema-operativo" aria-hidden="true">#</a></h2><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Para esta parte necesitarás:</p><ul><li>Un ordenador con internet.</li><li>Un pendrive de unos <strong>4GB</strong> vacío o con archivos que no te importe perder.</li><li>Una pantalla y teclado extra para el servidor.</li></ul></div><p>Hay varias opciones para escoger como sistema operativo:</p><ul><li><a href="https://www.debian.org/" target="_blank" rel="noreferrer">Debian</a>.</li><li><a href="https://www.raspbian.org/" target="_blank" rel="noreferrer">Raspbian</a> <em>(para Raspberry)</em>.</li><li><a href="https://ubuntu.com/download/server" target="_blank" rel="noreferrer">Ubuntu Server</a>.</li><li><a href="https://getfedora.org/en/server/" target="_blank" rel="noreferrer">Fedora Server</a>.</li></ul><p>Esos son solo algunos ejemplos, pero hay muchas opciones. En nuestro caso, el servidor tuvo instalado al principio Ubuntu Server, pero Lucas se puso tonto, así que ha habido que cambiarlo a <strong>Debian</strong>, que según él es mejor <em>(<strong>Spoiler:</strong> No ha probado Ubuntu Server)</em>.</p><div class="danger custom-block"><p class="custom-block-title">PELIGRO</p><p>Toda persona que use Windows Server será perseguida y juzgada por sus crímenes contra la humanidad.</p></div><h3 id="descarga-y-preparacion-del-instalador-de-debian-11" tabindex="-1">Descarga y preparación del instalador de Debian 11 <a class="header-anchor" href="#descarga-y-preparacion-del-instalador-de-debian-11" aria-hidden="true">#</a></h3><p>Actualmente la versión de Debian del servidor es la 11, también llamada Bullseye. La forma más sencilla de instalarlo es descargar la ISO del principio de su <a href="https://www.debian.org/download" target="_blank" rel="noreferrer">página de descarga</a>, ya que es un instalador muy ligero.</p><div class="warning custom-block"><p class="custom-block-title">ADVERTENCIA</p><p>Esa ISO de Debian necesita que el servidor se pueda conectar a internet en el momento de la instalación, así que ten preparado el cable para conectarlo.</p></div><p>Una vez descargada la ISO, tenemos que grabarla en el pendrive cosa que se puede hacer con <a href="https://www.balena.io/etcher/" target="_blank" rel="noreferrer">Balena Etcher</a>.</p><p>Ese pendrive lo cogemos y lo enchufamos al servidor.</p><h2 id="configuracion-de-la-bios-del-servidor" tabindex="-1">Configuración de la BIOS del servidor <a class="header-anchor" href="#configuracion-de-la-bios-del-servidor" aria-hidden="true">#</a></h2><p>Antes de instalar el sistema operativo, tenemos que hacer unos retoques en la BIOS, así que enciende el servidor y accede a la BIOS <em>(si no sabes cómo, búscalo, porque cambia mucho de un ordenador a otro)</em>.</p><p>Aquí hay <strong>dos cambios muy importantes</strong> que hacer:</p><ul><li><strong>Desactivar</strong>, si estuviera activado, el <strong>Secure Boot</strong>, ya que es algo de Windows y puede dar problemas para encender los ordenadores con Linux.</li><li>Establecer una <strong>contraseña de administrador</strong> de la BIOS.</li></ul><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Puede que te encuentres con dos posibles contraseñas, la de <strong>usuario</strong> y la de <strong>administrador</strong>. La de usuario, si la creas, probablemente te la pida cada vez que el ordenador se encienda, cosa que no te conviene. La de administrador es la que nos interesa, que es la que se pide cuando se intenta acceder a la BIOS.</p></div><p>Ahora hay que ir al apartado de <strong>Boot</strong> y cambiar el orden de inicio de los dispositivos para poner como primera opción el USB donde tenemos el instalador del sistema operativo.</p><p>Salimos guardando los cambios y el ordeandor debería reiniciarse y mostrar el instalador del sistema.</p><h2 id="instalacion-de-debian-11" tabindex="-1">Instalación de Debian 11 <a class="header-anchor" href="#instalacion-de-debian-11" aria-hidden="true">#</a></h2><p>Así se verá nuestro instalador:</p><p><img src="/server/assets/debian-inicio.e86551c4.png" alt="Instalador"></p><p>La instalación gráfica y la otra son prácticamente iguales, la diferencia es que en la gráfica puedes usar el ratón.</p><p>Primero tocará elegir el idioma y la distribución del teclado <em>(nosotros hemos elegido Español para mayor comodidad)</em>. Después se intentará conectar a internet y tocará poner unos cuantos datos:</p><ol><li>El nombre de la máquina, como puede ser <code>server</code></li><li>El nombre del dominio, que para nuestro servidor es <code>servermamadisimo.xyz</code> <em>(si no tienes el dominio o no sabes qué es, puedes hacerte spolier mirando la sección de <a href="./router-dominio.html#dominio-¿que-es-y-para-que-sirve">Router y dominio</a>)</em>.</li><li>La contraseña para el usuario <code>root</code>. Esta contraseña tiene que ser <strong>potente</strong>, como de 20 caracteres, porque es la que permite hacer cualquier cambio en el sistema operativo.</li></ol><div class="tip custom-block"><p class="custom-block-title">TRUQUITO</p><p>Puedes generar, guardar y gestionar contraseñas cómodamente con <a href="https://bitwarden.com/" target="_blank" rel="noreferrer">Bitwarden</a>.</p></div><ol start="4"><li>El nombre del usuario administrativo, por ejemplo, <code>admin</code> <em>(tanto para el nombre completo como para el nombre de usuario)</em>.</li></ol><div class="warning custom-block"><p class="custom-block-title">ADVERTENCIA</p><p>El usuario escogido en la guía es <code>admin</code>. Este nombre es de ejemplo y Debian no te dejará usarlo. Intenta escoger otro distinto que no sea tan fácil de averiguar.</p></div><ol start="5"><li>La contraseña para el usuario <code>admin</code>. Una contraseña que sea buena, aunque no es necesario que sea tan extensa como la de <code>root</code>.</li><li>Configuración del reloj, de chill.</li></ol><p>Después de esto toca poner una encriptación en el disco de instalación.</p><h3 id="encriptacion-del-disco" tabindex="-1">Encriptación del disco <a class="header-anchor" href="#encriptacion-del-disco" aria-hidden="true">#</a></h3><p>Para no complicarnos la vida, aquí dejaremos que Debian haga la magia de gestionar las particiones porque si no nos tocaría sufrir mucho.</p><p>En el instalador, elegiremos el método de particionado <strong>Guiado - utilizar todo el disco y configurar LVM cifrado</strong>. Elegimos el disco donde queremos instalar el sistema operativo, que en nuestro caso es la SSD de 480GB y utilizamos como esquema de particionado <strong>Todos los ficheros en una partición (recomendado para novatos)</strong>.</p><p>Ahora, si aprecias tu tiempo y no tenías archivos altamente sensibles en el disco donde vas a instalar Debian, puedes elegir no borrar el disco, ya que tardaría un buen rato.</p><p>Tras eso, nos pedirá una <strong>contraseña de cifrado</strong> y esta sí que tiene que ser una tremenda contraseña. Igual o mejor que la del usuario <code>root</code>.</p><p>Ahora toca lo interesante. Le decimos que use todo el disco para el particionado y nos aparecerá una lista con las particiones que se van a crear.</p><p><img src="/server/assets/debian-particiones.5298fdb5.png" alt="Particiones"></p><p>Las particiones más importantes son:</p><ul><li>Una partición donde irá <strong>el sistema operativo y todos los datos</strong>. Por defecto aparecerá con el sistema de archivos <code>ext4</code>, uno de los más comunes en Linux.</li><li>Una partición de <strong>intercambio <em>(SWAP)</em></strong>, que se utiliza como una ampliación de la RAM.</li><li>Una partición <code>boot</code> que contiene los archivos necesarios para que el ordenador se encienda.</li></ul><p>Se puede dejar tal y como está, pero nosotros hemos optado por usar <code>btrfs</code> en vez de <code>ext4</code> como sistema de archivos de la partición principal. Esto es por las grandes facilidades que da <code>btrfs</code> para hacer copias de seguridad del sistema al completo sin que ocupen casi espacio.</p><p>Por suerte, cambiar el sistema de archivos es relativamente fácil, solo hay que ir a la línea donde aparece la palabra <code>ext4</code>, pulsar &lt;Intro&gt; y en <strong>Utilizar como</strong> elegir el sistema <code>btrfs</code>. Salimos y ahora debería aparecer <code>btrfs</code> en vez de <code>ext4</code> como sistema de archivos. Finalizamos el particionado confirmando que se hagan los cambios elegidos y empezará la instalación del sistema operativo.</p><h3 id="terminando-la-instalacion" tabindex="-1">Terminando la instalación <a class="header-anchor" href="#terminando-la-instalacion" aria-hidden="true">#</a></h3><p>Una vez acabe la instalación, nos tocará configurar el gestor de paquetes, elegir una ubicación y un proxy si hace falta, pero se puede dejar todo por defecto y el proxy en blanco.</p><p>Ahora nos dejará elegir unos cuantos paquetes extra que instalar, estos son los cambios que hay que hacer:</p><div class="warning custom-block"><p class="custom-block-title">ADVERTENCIA</p><p>Si no quieres que se te quede la cara de tonto que se me quedó a mí ya en dos ocasiones, recuerda que para desmarcar opciones hay que usar &lt;Espacio&gt; y no &lt;Intro&gt;, que como le des sin querer te toca repetir todo el proceso de instalación.</p></div><ul><li>Quitar el entorno de escritorio. El servidor no lo necesitará allá donde vas a dejarlo.</li><li>Añadir el servidor SSH, que nos permitirá conectarnos al servidor remotamente desde otro dispositivo para hacer cualquier gestión.</li></ul><h2 id="configuracion-basica-y-pequenas-mejoras" tabindex="-1">Configuración básica y pequeñas mejoras <a class="header-anchor" href="#configuracion-basica-y-pequenas-mejoras" aria-hidden="true">#</a></h2><p>Encendemos el servidor, iniciamos sesión con el nombre de usuario que creamos, con su contraseña y ya estaría.</p><p>Lo primero que vamos a hacer, por comodidad, es instalar el paquete <code>sudo</code>, que nos permite hacer casi todo lo que hace el usuario <code>root</code> sin necesidad de cambiarnos a ese usuario, para ello escribimos los siquientes comandos:</p><div class="language-"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ su</span></span>
<span class="line"><span style="color:#A6ACCD;">Contraseña:</span></span>
<span class="line"><span style="color:#A6ACCD;">$ apt install sudo</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>Ahora queda añadir al usuario que creamos durante la instalación como <em>sudoer</em>, para ello escribimos <code>nano /etc/sudoers</code> y ponemos lo siguiente:</p><div class="language-bash"><button class="copy"></button><span class="lang">bash</span><pre><code><span class="line"><span style="color:#676E95;">#</span></span>
<span class="line"><span style="color:#676E95;"># This file MUST be edited with the &#39;visudo&#39; command as root.</span></span>
<span class="line"><span style="color:#676E95;">#</span></span>
<span class="line"><span style="color:#676E95;"># Please consider adding local content in /etc/sudoers.d/ instead of</span></span>
<span class="line"><span style="color:#676E95;"># directly modifying this file.</span></span>
<span class="line"><span style="color:#676E95;">#</span></span>
<span class="line"><span style="color:#676E95;"># See the man page for details on how to write a sudoers file.</span></span>
<span class="line"><span style="color:#676E95;">#</span></span>
<span class="line"><span style="color:#A6ACCD;">Defaults        env_reset</span></span>
<span class="line"><span style="color:#A6ACCD;">Defaults        mail_badpass</span></span>
<span class="line"><span style="color:#A6ACCD;">Defaults        secure_path=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># Host alias specification</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># User alias specification</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># Cmnd alias specification</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># User privilege specification</span></span>
<span class="line"><span style="color:#A6ACCD;">root    ALL=</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">ALL:ALL</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> ALL</span></span>
<span class="line"><span style="color:#A6ACCD;">admin  ALL=</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">ALL:ALL</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> ALL</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># Allow members of group sudo to execute any command</span></span>
<span class="line"><span style="color:#A6ACCD;">%sudo   ALL=</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">ALL:ALL</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> ALL</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># See sudoers(5) for more information on &quot;@include&quot; directives:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">@includedir /etc/sudoers.d</span></span>
<span class="line"></span></code></pre></div><p>Donde <code>admin</code> será el usuario que creamos. Guardamos el archivo y ya podemos escribir <code>exit</code> para salirnos del usuario <code>root</code>. A partir de ahora lo normal será usar <code>sudo</code> para instalar cosas o editar archivos.</p><h3 id="optimizando-el-disco-ssd" tabindex="-1">Optimizando el disco SSD <a class="header-anchor" href="#optimizando-el-disco-ssd" aria-hidden="true">#</a></h3><p><strong>Si tenemos el sistema operativo en un disco SSD</strong>, como es el caso, hay unos cambios que podemos hacer para mejorar el rendimiento y la durabilidad del disco, tenemos que editar <code>/etc/fstab</code>, concretamente la primera línea sin comentar, que debería ser la correspondiente al sistema de archivos <code>root</code>, añadiendo unas opciones extra para cuando se monte la partición:</p><div class="language-"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;"># /etc/fstab: static file system information.</span></span>
<span class="line"><span style="color:#A6ACCD;">#</span></span>
<span class="line"><span style="color:#A6ACCD;"># Use &#39;blkid&#39; to print the universally unique identifier for a</span></span>
<span class="line"><span style="color:#A6ACCD;"># device; this may be used with UUID= as a more robust way to name devices</span></span>
<span class="line"><span style="color:#A6ACCD;"># that works even if disks are added and removed. See fstab(5).</span></span>
<span class="line"><span style="color:#A6ACCD;">#</span></span>
<span class="line"><span style="color:#A6ACCD;"># systemd generates mount units based on this file, see systemd.mount(5).</span></span>
<span class="line"><span style="color:#A6ACCD;"># Please run &#39;systemctl daemon-reload&#39; after making changes here.</span></span>
<span class="line"><span style="color:#A6ACCD;">#</span></span>
<span class="line"><span style="color:#A6ACCD;"># &lt;file system&gt; &lt;mount point&gt;   &lt;type&gt;  &lt;options&gt;       &lt;dump&gt;  &lt;pass&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">/dev/mapper/server--vg-root /               btrfs   defaults,subvol=@rootfs,ssd,noatime,space_cache,commit=120,compress=zstd,discard=async 0       0</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>El resto de líneas que haya debajo las dejamos intactas.</p><h3 id="montando-el-disco-tocho-en-el-encendido" tabindex="-1">Montando el disco tocho en el encendido <a class="header-anchor" href="#montando-el-disco-tocho-en-el-encendido" aria-hidden="true">#</a></h3><p>Como que tenemos un disco duro de 4TB que vamos a usar para almacenar archivos, necesitamos que se desencripte también y se monte al encenderse el servidor, así que vamos a ello.</p><p>Lo primero es que se desencripte, para ello tendremos que añadir el disco a <code>/etc/crypttab</code>, pero como ese queremos que se desencripte solo sin tener que ponerle nosotros la contraseña, tendremos que crear un archivo que servirá como contraseña para desencriptar el disco. Localizamos el disco, que en este caso es <code>sdb1</code>:</p><div class="language-"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ lsblk</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME                    MAJ:MIN RM   SIZE RO TYPE  MOUNTPOINT</span></span>
<span class="line"><span style="color:#A6ACCD;">sda                       8:0    0 447,1G  0 disk  </span></span>
<span class="line"><span style="color:#A6ACCD;">├─sda1                    8:1    0   512M  0 part  /boot/efi</span></span>
<span class="line"><span style="color:#A6ACCD;">├─sda2                    8:2    0   488M  0 part  /boot</span></span>
<span class="line"><span style="color:#A6ACCD;">└─sda3                    8:3    0 446,2G  0 part  </span></span>
<span class="line"><span style="color:#A6ACCD;">  └─sda3_crypt          254:0    0 446,1G  0 crypt </span></span>
<span class="line"><span style="color:#A6ACCD;">    ├─server--vg-root   254:1    0 445,1G  0 lvm   /var/lib/docker/btrfs</span></span>
<span class="line"><span style="color:#A6ACCD;">    └─server--vg-swap_1 254:2    0   976M  0 lvm   [SWAP]</span></span>
<span class="line"><span style="color:#A6ACCD;">sdb                       8:16   0   3,6T  0 disk  </span></span>
<span class="line"><span style="color:#A6ACCD;">└─sdb1                    8:17   0   3,6T  0 part  </span></span>
<span class="line"><span style="color:#A6ACCD;">sr0                      11:0    1  1024M  0 rom  </span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>Ahora hay que buscar su UUID:</p><div class="language-"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ ls -l /dev/disk/by-uuid</span></span>
<span class="line"><span style="color:#A6ACCD;">total 0</span></span>
<span class="line"><span style="color:#A6ACCD;">lrwxrwxrwx 1 root root 10 ago 10 17:47 0053a965-9146-4e52-b842-0ba1a756c4c5 -&gt; ../../sda3</span></span>
<span class="line"><span style="color:#A6ACCD;">lrwxrwxrwx 1 root root 10 ago 10 17:47 1e28c433-5bf5-41e5-9708-5730bb18d0ef -&gt; ../../dm-2</span></span>
<span class="line"><span style="color:#A6ACCD;">lrwxrwxrwx 1 root root 10 ago 10 17:47 60e8d58f-cb05-47f1-85bc-38e5b0a05505 -&gt; ../../sdb1</span></span>
<span class="line"><span style="color:#A6ACCD;">lrwxrwxrwx 1 root root 10 ago 10 17:47 a3313b2a-fe80-4f3c-a384-bbce92fd4301 -&gt; ../../dm-1</span></span>
<span class="line"><span style="color:#A6ACCD;">lrwxrwxrwx 1 root root 10 ago 10 17:47 E283-990E -&gt; ../../sda1</span></span>
<span class="line"><span style="color:#A6ACCD;">lrwxrwxrwx 1 root root 10 ago 10 17:47 eb777051-9d3a-4bf9-a186-fdfcc9d5c9c0 -&gt; ../../sda2</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>Que en este caso es <code>60e8d58f-cb05-47f1-85bc-38e5b0a05505</code>, lo guardamos y vamos a crear el archivo que servirá de clave:</p><div class="language-"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ sudo dd if=/dev/urandom of=/root/hdd_key bs=1024 count=4</span></span>
<span class="line"><span style="color:#A6ACCD;">$ sudo chmod 0400 /root/hdd_key</span></span>
<span class="line"><span style="color:#A6ACCD;">$ sudo cryptsetup luksAddKey /dev/sdb1 /root/hdd_key</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>Lo que acabamos de hacer es crear un archivo con carácteres aleatorios <em>(como una contraseña básicamente pero mucho más larga)</em> y añadirlo como clave para desencriptar el disco duro, ya que LUKS nos permite tener varias claves. Ahora sí, hay que editar <code>/etc/fstab</code> añadiendo esta línea al final:</p><div class="language-"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">vault UUID=60e8d58f-cb05-47f1-85bc-38e5b0a05505 /root/hdd_key luks</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>Donde lo primero es el nombre que tendrá el volumen, lo segundo su UUID <em>(no olvidar comprobar que sea el correcto)</em>, lo tercero el archivo donde está la clave y lo cuarto especifica que utiliza LUKS.</p><p>Muy bien, con esto el disco se desencriptará al encenderse el servidor, solo nos queda añadirlo a <code>/etc/fstab</code> para que también se monte. Añadimos esta línea al final del archivo:</p><div class="language-"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">/dev/mapper/vault /mnt/vault btrfs defaults,nofail 0 0</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>Que hará que el disco se monte en <code>/mnt/vault</code> cuando se encienda el servidor. La opción <code>nofail</code> hace que, aunque no se pueda montar el disco, el ordenador se siga encendiendo en vez de fallar.</p></div></div></main><!--[--><!--]--><footer class="VPDocFooter" data-v-f0af2311 data-v-a54a85bd><div class="edit-info" data-v-a54a85bd><!----><div class="last-updated" data-v-a54a85bd><p class="VPLastUpdated" data-v-a54a85bd data-v-f7d51a9c>Actualizado por última vez: <time datatime="2022-09-01T10:34:03.000Z" data-v-f7d51a9c></time></p></div></div><div class="prev-next" data-v-a54a85bd><div class="pager" data-v-a54a85bd><a class="pager-link prev" href="/server/equipo/hardware.html" data-v-a54a85bd><span class="desc" data-v-a54a85bd>Previous page</span><span class="title" data-v-a54a85bd>Hardware</span></a></div><div class="has-prev pager" data-v-a54a85bd><a class="pager-link next" href="/server/equipo/router-dominio.html" data-v-a54a85bd><span class="desc" data-v-a54a85bd>Next page</span><span class="title" data-v-a54a85bd>Configuración del router y dominio</span></a></div></div></footer><!--[--><!--]--></div></div></div></div></div><footer class="VPFooter has-sidebar" data-v-ca9ccb7e data-v-9f24cc86><div class="container" data-v-9f24cc86><p class="message" data-v-9f24cc86>Distribuido bajo la licencia CC BY.</p><p class="copyright" data-v-9f24cc86>Copyright © 2022-presente Lucas de Uña Ocampo e Iván Salido Cobo</p></div></footer><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"equipo_docker.md\":\"a2c59cfc\",\"equipo_gestion-remota.md\":\"b5c4a9a8\",\"equipo_hardware.md\":\"3373c93f\",\"equipo_mariadb-docker.md\":\"a4b877fc\",\"equipo_nginx.md\":\"b998a55c\",\"equipo_router-dominio.md\":\"d0142941\",\"equipo_sistema-encriptado.md\":\"7345a3e3\",\"index.md\":\"8a702fb4\",\"relatos_bloqueo-ssh.md\":\"e64e7a63\",\"relatos_initramfs-vs-router.md\":\"0d4d9ac9\",\"relatos_usuario-docker.md\":\"ae2a29ef\",\"servicios_authentik.md\":\"009d059c\",\"servicios_dozzle.md\":\"cb6be057\",\"servicios_gitea.md\":\"356a9813\",\"servicios_homarr.md\":\"51747841\",\"servicios_minecraft.md\":\"ad9a09b3\",\"servicios_nextcloud.md\":\"373aff9b\",\"servicios_uptime-kuma.md\":\"d9c0c7e7\"}")</script>
    <script type="module" async src="/server/assets/app.bf15efc8.js"></script>
    
  </body>
</html>