import{_ as a,c as i,o as e,ak as n,av as t}from"./chunks/framework.DtoNLqWc.js";const g=JSON.parse('{"title":"DynDNS con Namecheap","description":"","frontmatter":{"order":6,"title":"DynDNS con Namecheap"},"headers":[],"relativePath":"relatos/dyndns-namecheap.md","filePath":"relatos/dyndns-namecheap.md","lastUpdated":1769202331000}'),l={name:"relatos/dyndns-namecheap.md"};function p(d,s,h,r,o,k){return e(),i("div",null,[...s[0]||(s[0]=[n('<h1 id="actualizar-la-ip-del-servidor-en-namecheap" tabindex="-1">Actualizar la IP del servidor en Namecheap <a class="header-anchor" href="#actualizar-la-ip-del-servidor-en-namecheap" aria-label="Permalink to “Actualizar la IP del servidor en Namecheap”">​</a></h1><p><em>Esta es la configuración que usamos cuando teníamos el dominio gestionado con Namechap, antes de moverlo a Cloudflare.</em></p><p>Comenzamos creando el registro <code>A</code> o <code>A + Dynamic DNS Record</code> (funcionan igual) para el dominio y los subdominios. <img src="'+t+`" alt="Registros A + Dynamic DNS Record de Namecheap"></p><div class="info custom-block"><p class="custom-block-title custom-block-title-default">INFO</p><p>Los registros A asocian un nombre de dominio con una dirección IPv4. En IPv6 se utilizan registros AAAA. Hay muchos más tipos de registros DNS, que puedes ver <a href="https://www.cloudflare.com/learning/dns/dns-records/" target="_blank" rel="noreferrer">aquí</a>.</p></div><p>Por desgracia, el programa que tiene disponible Namecheap es solo para Windows, pero igualmente existe la posibilidad de utilizar un enlace para actualizar la IP. Aun así, no utilizaremos directamente el enlace, ya que podemos aprovecharnos de la existencia de <a href="https://github.com/nickjer/namecheap-ddns" target="_blank" rel="noreferrer">este</a> repositorio.</p><p>Siguiendo su documentación vamos a instalarlo usando <code>cargo</code>, así que también tendremos que <a href="https://www.rust-lang.org/tools/install" target="_blank" rel="noreferrer">instalar Rust</a>.</p><p>Una vez instalado Rust, ejecutamos <code>cargo install namecheap-ddns</code> y tendremos el ejecutable en <code>/home/admin/.cargo/bin/namecheap-ddns</code>.</p><p>Siguiendo nuevamente la documentación, vamos a crear un servicio de <code>systemd</code> para que se encargue de actualizar la IP del dominio y todos sus subdominios. Creamos el archivo <code>/etc/systemd/system/ddns-update.service</code>:</p><div class="language-ini"><button title="Copy Code" class="copy"></button><span class="lang">ini</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[Unit]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=Update DDNS records for Namecheap</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">After</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=nss-user-lookup.target</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Wants</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=nss-user-lookup.target</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[Service]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=simple</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Environment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NAMECHEAP_DDNS_TOKEN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=passwd</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Environment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NAMECHEAP_DDNS_DOMAIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=wupp.dev</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Environment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NAMECHEAP_DDNS_SUBDOMAIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=@,mc,www</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ExecStart</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=/home/admin/.cargo/bin/namecheap-ddns</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">User</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=admin</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[Install]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WantedBy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=default.target</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">ADVERTENCIA</p><p>Si no escribimos el <code>@</code> al principio de <code>Environment=NAMECHEAP_DDNS_SUBDOMAIN</code>, no se nos actualizará el dominio base <code>wupp.dev</code>.</p></div><p>Ejecutamos <code>sudo chmod 600 /etc/systemd/system/ddns-update.service</code> (esto evita que otros usuarios del sistema puedan leer el token) y creamos el archivo <code>/etc/systemd/system/ddns-update.timer</code>:</p><div class="language-ini"><button title="Copy Code" class="copy"></button><span class="lang">ini</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[Unit]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=Run DDNS update every 15 minutes</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Requires</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=ddns-update.service</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[Timer]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Unit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=ddns-update.service</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OnUnitInactiveSec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=15m</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AccuracySec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=1s</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[Install]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WantedBy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=timers.target</span></span></code></pre></div><p>Y ejecutamos los siguientes comandos para ponerlo en funcionamiento y comprobar que todo va bien:</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> daemon-reload</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --now</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ddns-update.service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ddns-update.timer</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> journalctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ddns-update.service</span></span></code></pre></div>`,14)])])}const u=a(l,[["render",p]]);export{g as __pageData,u as default};
