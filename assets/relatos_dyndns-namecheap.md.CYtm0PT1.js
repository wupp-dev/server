import{_ as i,c as a,o as e,ak as n,av as t}from"./chunks/framework.DtoNLqWc.js";const u=JSON.parse('{"title":"DynDNS con Namecheap","description":"","frontmatter":{"order":6,"title":"DynDNS con Namecheap"},"headers":[],"relativePath":"relatos/dyndns-namecheap.md","filePath":"relatos/dyndns-namecheap.md","lastUpdated":1769212283000}'),l={name:"relatos/dyndns-namecheap.md"};function p(r,s,o,h,d,k){return e(),a("div",null,[...s[0]||(s[0]=[n('<h1 id="actualizar-la-ip-del-servidor-en-namecheap" tabindex="-1">Actualizar la IP del servidor en Namecheap <a class="header-anchor" href="#actualizar-la-ip-del-servidor-en-namecheap" aria-label="Permalink to “Actualizar la IP del servidor en Namecheap”">​</a></h1><p><em>Esta es la configuración que usamos cuando teníamos el dominio gestionado con Namechap, antes de moverlo a Cloudflare.</em></p><h2 id="con-el-servidor-encendido" tabindex="-1">Con el servidor encendido <a class="header-anchor" href="#con-el-servidor-encendido" aria-label="Permalink to “Con el servidor encendido”">​</a></h2><p>Comenzamos creando el registro <code>A</code> o <code>A + Dynamic DNS Record</code> (funcionan igual) para el dominio y los subdominios. <img src="'+t+`" alt="Registros A + Dynamic DNS Record de Namecheap"></p><div class="info custom-block"><p class="custom-block-title custom-block-title-default">INFO</p><p>Los registros A asocian un nombre de dominio con una dirección IPv4. En IPv6 se utilizan registros AAAA. Hay muchos más tipos de registros DNS, que puedes ver <a href="https://www.cloudflare.com/learning/dns/dns-records/" target="_blank" rel="noreferrer">aquí</a>.</p></div><p>Por desgracia, el programa que tiene disponible Namecheap es solo para Windows, pero igualmente existe la posibilidad de utilizar un enlace para actualizar la IP. Aun así, no utilizaremos directamente el enlace, ya que podemos aprovecharnos de la existencia de <a href="https://github.com/nickjer/namecheap-ddns" target="_blank" rel="noreferrer">este</a> repositorio.</p><p>Siguiendo su documentación vamos a instalarlo usando <code>cargo</code>, así que también tendremos que <a href="https://www.rust-lang.org/tools/install" target="_blank" rel="noreferrer">instalar Rust</a>.</p><p>Una vez instalado Rust, ejecutamos <code>cargo install namecheap-ddns</code> y tendremos el ejecutable en <code>/home/admin/.cargo/bin/namecheap-ddns</code>.</p><p>Siguiendo nuevamente la documentación, vamos a crear un servicio de <code>systemd</code> para que se encargue de actualizar la IP del dominio y todos sus subdominios. Creamos el archivo <code>/etc/systemd/system/ddns-update.service</code>:</p><div class="language-ini"><button title="Copy Code" class="copy"></button><span class="lang">ini</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[Unit]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=Update DDNS records for Namecheap</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">After</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=nss-user-lookup.target</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Wants</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=nss-user-lookup.target</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[Service]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=simple</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Environment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NAMECHEAP_DDNS_TOKEN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=passwd</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Environment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NAMECHEAP_DDNS_DOMAIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=wupp.dev</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Environment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NAMECHEAP_DDNS_SUBDOMAIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=@,mc,www</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ExecStart</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=/home/admin/.cargo/bin/namecheap-ddns</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">User</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=admin</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[Install]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WantedBy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=default.target</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">ADVERTENCIA</p><p>Si no escribimos el <code>@</code> al principio de <code>Environment=NAMECHEAP_DDNS_SUBDOMAIN</code>, no se nos actualizará el dominio base <code>wupp.dev</code>.</p></div><p>Ejecutamos <code>sudo chmod 600 /etc/systemd/system/ddns-update.service</code> (esto evita que otros usuarios del sistema puedan leer el token) y creamos el archivo <code>/etc/systemd/system/ddns-update.timer</code>:</p><div class="language-ini"><button title="Copy Code" class="copy"></button><span class="lang">ini</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[Unit]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=Run DDNS update every 15 minutes</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Requires</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=ddns-update.service</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[Timer]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Unit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=ddns-update.service</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">OnUnitInactiveSec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=15m</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AccuracySec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=1s</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[Install]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WantedBy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=timers.target</span></span></code></pre></div><p>Y ejecutamos los siguientes comandos para ponerlo en funcionamiento y comprobar que todo va bien:</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> daemon-reload</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --now</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ddns-update.service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ddns-update.timer</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> journalctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ddns-update.service</span></span></code></pre></div><h2 id="cuando-el-servidor-esta-esperando-a-ser-desencriptado" tabindex="-1">Cuando el servidor está esperando a ser desencriptado <a class="header-anchor" href="#cuando-el-servidor-esta-esperando-a-ser-desencriptado" aria-label="Permalink to “Cuando el servidor está esperando a ser desencriptado”">​</a></h2><p>El objetivo es crear una tarea de <code>crontab</code> para ir actualizando la IP cada cierto tiempo durante el encendido. El primer problema que nos encontramos para esto es que los comandos disponibles cuando estamos en <code>ìnitramfs</code> son muy pocos y no incluyen <code>crontab</code>. Concretamente, los comandos que hay disponibles son una versión reducida de <a href="https://busybox.net/" target="_blank" rel="noreferrer">BusyBox</a> y para poder usar <code>crontab</code> necesitamos la versión completa.</p><p><code>initramfs</code> utiliza la versión de BusyBox que haya instalada en Debian, así que tenemos que cambiarla escribiendo <code>sudo apt install busybox-static</code>, que reemplazará a la anterior y se incluirá automáticamente en <code>initramfs</code>.</p><div class="danger custom-block"><p class="custom-block-title">PELIGRO</p><p>Aunque seguramente no sea el caso, puede ser que al hacer esto se cree una incompatibilidad entre la nueva versión de BusyBox y el resto de componentes de <code>initramfs</code>, haciendo que el servidor no pueda encenderse, así que recomiendo hacer una copia de seguridad por si algo sale mal.</p></div><p>Después de esto <code>crontab</code> ya estará disponible, pero no funcionará porque en <code>initramfs</code> el directorio donde se guarda por defecto el archivo con la configuración no existe. La forma de resolverlo es creando el archivo <code>/usr/share/initramfs-tools/hooks/crontab</code> con este contenido:</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#!/bin/sh -e</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;prereqs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ]; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">then</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> exit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">fi</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/share/initramfs-tools/hook-functions</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $DESTDIR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/var</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $DESTDIR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/var/spool</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $DESTDIR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/var/spool/cron</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $DESTDIR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/var/spool/cron/crontabs</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/share/initramfs-tools/crontab</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $DESTDIR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/var/spool/cron/crontabs/root</span></span></code></pre></div><p>Escribimos <code>sudo chmod +x /usr/share/initramfs-tools/hooks/crontab</code> para hacer el archivo ejecutable y esto lo que hará es crear el directorio y copiar un archivo con la configuración de <code>crontab</code> que vamos a crear ahora mismo. Escribimos en <code>/usr/share/initramfs-tools/crontab</code> la línea necesaria para actualizar únicamente <code>wupp.dev</code>, ya que el resto de subdominios nos da igual que se actualicen ahora si no van a poder usarse porque el ordenador no está completamente encendido:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>1,6,11,16,21,26,31,36,41,46,51,56 * * * * sleep 46 ; wget --no-check-certificate -qO- ipinfo.io/ip -O - | xargs -I {} wget --no-check-certificate -qO- &quot;https://dynamicdns.park-your-domain.com/update?host=@&amp;domain=wupp.dev&amp;password=passwd&amp;ip={}&quot; &gt; /tmp/dnsupdate.log 2&gt;&amp;1 &amp;</span></span></code></pre></div><p>Y restringimos los permisos del archivo escribiendo:</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> chown</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root:root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/share/initramfs-tools/crontab</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> chmod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 600</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/share/initramfs-tools/crontab</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">ADVERTENCIA</p><p>Por mucho que hayamos restringido los permisos del archivo, se va a guardar en una partición que no está cifrada, así que cualquiera que pueda acceder al disco podrá ver el token y &quot;secuestrar&quot; nuestro dominio para redirigirlo a donde quiera. Tenlo en cuenta.</p></div><p>Cada vez que ejecutemos <code>sudo update-initramfs -u</code> se volverá a crear el directorio y a copiar el archivo, con lo que también nos aseguraremos de que si cambiamos el archivo también se cambiará en <code>initramfs</code>, aunque no inmediatamente.</p><p>Sin embargo, aunque ya podemos usar <code>crontab</code> en <code>initramfs</code>, nos falta hacer que se empiece a ejecutar, así que tenemos que crear otro archivo que se encargue de iniciar <code>crond</code>, que ejecutará lo que haya en <code>crontab</code>. Ese archivo será <code>/usr/share/initramfs-tools/scripts/init-premount/crond</code> y tendrá este contenido:</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#!/bin/sh</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Start crond</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PREREQ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;busybox&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">prereqs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$PREREQ</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">case</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> $1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> in</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">prereqs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        prereqs</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        exit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ;;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">esac</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /scripts/functions</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">crond</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -l</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span></code></pre></div><p>Que no se nos olvide hacer el archivo ejecutable escribiendo <code>sudo chmod +x /usr/share/initramfs-tools/scripts/init-premount/crond</code>.</p><p>Genial, ahora si probamos a reiniciar el ordenador nos encontraremos con otro problema, y es que la resolución de dominios no funciona. Podemos comprobarlo con un comando tan sencillo como <code>wget google.com</code>, que nos dará un error.</p><div class="tip custom-block"><p class="custom-block-title">RELATO</p><p>La información que hay en Internet sobre cómo hacer funcionar la resolución de dominios en <code>initramfs</code> es casi nula, así que la forma en la que lo conseguimos fue con varias pruebas que puedes consultar <a href="./../relatos/dns-initramfs">aquí</a>.</p></div><p>Para arreglarlo, crearemos un último archivo <code>/usr/share/initramfs-tools/hooks/dns</code> con el contenido:</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#!/bin/sh -e</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;prereqs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ]; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">then</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> exit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">fi</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/share/initramfs-tools/hook-functions</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/lib/x86_64-linux-gnu/libnss_dns.so.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $DESTDIR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/usr/lib/x86_64-linux-gnu/libnss_dns.so.2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/resolv.conf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $DESTDIR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/etc/resolv.conf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/host.conf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $DESTDIR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/etc/host.conf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/hosts</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $DESTDIR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/etc/hosts</span></span></code></pre></div><p>Y lo hacemos ejecutable con <code>sudo chmod +x /usr/share/initramfs-tools/hooks/dns</code>. Hecho esto ejecutamos una última vez <code>sudo update-initramfs -u</code> y ya estaría.</p>`,35)])])}const g=i(l,[["render",p]]);export{u as __pageData,g as default};
